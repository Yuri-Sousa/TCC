function IsQueryObjectPreview(){return void 0!=window.external&&void 0!=window.external.SendText}function IsDashboardEdit(){return"undefined"!==typeof UCDashboardForEditor}function UpdateQueryObjectPreview(a){for(var c=Object.keys(qv.collection)[0],c=qv.collection[c],a=JSON.parse(a),e=Object.keys(a),b=0;b<e.length;b++){var d=e[b];c[d]=a[d]}c.realShow()}
var qv={collection:{},fadeTimeouts:{}},QueryViewerVisible={Always:"Always",Yes:"Yes",No:"No",Never:"Never"},QueryViewerElementType={Axis:"Axis",Datum:"Datum"},QueryViewerAxisType={Rows:"Rows",Columns:"Columns",Pages:"Pages"},QueryViewerFilterType={ShowAllValues:"ShowAllValues",HideAllValues:"HideAllValues",ShowSomeValues:"ShowSomeValues"},QueryViewerAxisOrderType={None:"None",Ascending:"Ascending",Descending:"Descending",Custom:"Custom"},QueryViewerExpandCollapseType={ExpandAllValues:"ExpandAllValues",
CollapseAllValues:"CollapseAllValues",ExpandSomeValues:"ExpandSomeValues"},QueryViewerDataType={Integer:"integer",Real:"real",Character:"character",Boolean:"boolean",Date:"date",DateTime:"datetime",GUID:"guid"},QueryViewerAggregationType={Sum:"Sum",Average:"Average",Count:"Count",Max:"Max",Min:"Min"},QueryViewerOutputType={Card:"Card",Chart:"Chart",PivotTable:"PivotTable",Table:"Table",Default:"Default"},QueryViewerChartType={Column:"Column",Column3D:"Column3D",StackedColumn:"StackedColumn",StackedColumn3D:"StackedColumn3D",
StackedColumn100:"StackedColumn100",Bar:"Bar",StackedBar:"StackedBar",StackedBar100:"StackedBar100",Area:"Area",StackedArea:"StackedArea",StackedArea100:"StackedArea100",SmoothArea:"SmoothArea",StepArea:"StepArea",Line:"Line",StackedLine:"StackedLine",StackedLine100:"StackedLine100",SmoothLine:"SmoothLine",StepLine:"StepLine",Pie:"Pie",Pie3D:"Pie3D",Doughnut:"Doughnut",Doughnut3D:"Doughnut3D",LinearGauge:"LinearGauge",CircularGauge:"CircularGauge",Radar:"Radar",FilledRadar:"FilledRadar",PolarArea:"PolarArea",
Funnel:"Funnel",Pyramid:"Pyramid",ColumnLine:"ColumnLine",Column3DLine:"Column3DLine",Timeline:"Timeline",SmoothTimeline:"SmoothTimeline",StepTimeline:"StepTimeline",Sparkline:"Sparkline"},QueryViewerConditionOperator={Equal:"EQ",LessThan:"LT",GreaterThan:"GT",LessOrEqual:"LE",GreaterOrEqual:"GE",NotEqual:"NE",Interval:"IN"},QueryViewerOrientation={Horizontal:"Horizontal",Vertical:"Vertical"},QueryViewerPlotSeries={InTheSameChart:"InTheSameChart",InSeparateCharts:"InSeparateCharts"},QueryViewerShowDataAs=
{Values:"Values",Percentages:"Percentages",ValuesAndPercentages:"ValuesAndPercentages"},QueryViewerSubtotals={Yes:"Yes",Hidden:"Hidden",No:"No"},QueryViewerTrendPeriod={SinceTheBeginning:"SinceTheBeginning",LastYear:"LastYear",LastSemester:"LastSemester",LastQuarter:"LastQuarter",LastMonth:"LastMonth",LastWeek:"LastWeek",LastDay:"LastDay",LastHour:"LastHour",LastMinute:"LastMinute",LastSecond:"LastSecond"},QueryViewerXAxisLabels={Horizontally:"Horizontally",Rotated30:"Rotated30",Rotated45:"Rotated45",
Rotated60:"Rotated60",Vertically:"Vertically"},QueryViewerAutoresizeType={Both:"Both",Vertical:"Vertical",Horizontal:"Horizontal"};
qv.util={color:{getHtmlColor:function(a){return"string"==typeof a||"number"==typeof a?gx.color.toHex?-1==a?"":"#"+gx.color.toHex(a):"#"+gxToHex(a):void 0==a?"#000000":a.Html},parseCSSColor:function(a){return"rgb"==a.substring(0,3)?(a=a.replace("rgb","").replace("(","").replace(")","").split(","),this.getHtmlColor(gx.color.rgb(parseInt(a[0]),parseInt(a[1]),parseInt(a[2])))):a},convertValueToColor:function(a){a=-1==a.indexOf("#")?"#"+a:a;for(a=a.substring(1,a.length);6>a.length;)a="0"+a;return"#"+a}},
css:function(){var a={};return{replaceCssClasses:function(c){for(;0<=(posIni=c.indexOf("gxpl_cssReplace("));){posFin=c.indexOf(")",posIni);className=c.substring(posIni+16,posFin);var e=className;if(void 0!=a[e])style=a[e];else{for(var b=e,d=void 0,s=gx.theme+".css",v=!1,g=void 0,m=0;m<document.styleSheets.length;m++)if(null!=document.styleSheets[m].href&&0<=document.styleSheets[m].href.indexOf(s)){v=!0;d=document.styleSheets[m];break}v&&(d.cssRules?crossRules=d.cssRules:d.rules&&(crossRules=d.rules));
d=Number.MAX_SAFE_INTEGER;for(m=0;m<crossRules.length;m++)s=crossRules[m],void 0!=s.selectorText&&(0==s.selectorText.toLowerCase().indexOf("."+b.toLowerCase())&&s.selectorText.length<d)&&(g=s.style,d=s.selectorText.length);styleObj=g;void 0!=styleObj?(b=styleObj,g="",""!=b.color&&(g+=(""==g?"":";")+"color:"+qv.util.color.parseCSSColor(b.color)),""!=b.backgroundColor&&(g+=(""==g?"":";")+"backgroundColor:"+qv.util.color.parseCSSColor(b.backgroundColor)),""!=b.borderStyle&&(g+=(""==g?"":";")+"borderStyle:"+
b.borderStyle),""!=b.borderWidth&&(g+=(""==g?"":";")+"borderThickness:"+b.borderWidth.replace("pt","").replace("px","")),""!=b.borderColor&&(g+=(""==g?"":";")+"borderColor:"+qv.util.color.parseCSSColor(b.borderColor)),""!=b.fontFamily&&(g+=(""==g?"":";")+"fontFamily:"+b.fontFamily.replace(/"/g,"").replace(/'/g,"")),""!=b.fontSize&&(g+=(""==g?"":";")+"fontSize:"+b.fontSize.replace("pt","").replace("px","")),""!=b.fontWeight&&(g+=(""==g?"":";")+"fontWeight:"+b.fontWeight),""!=b.fontStyle&&(g+=(""==
g?"":";")+"fontStyle:"+b.fontStyle),""!=b.textDecoration&&(g+=(""==g?"":";")+"textDecoration:"+b.textDecoration),styleTransformed=g,style=a[e]=styleTransformed):style=""}toReplace=c.substring(posIni,posFin+1);c=c.replace(toReplace,style)}return c},parseStyle:function(a){var e="";if(""!=a&&void 0!=a){if(0>a.indexOf(":"))return a;for(var a=a.split(";"),b=0;b<a.length;b++)var d=a[b].split(":"),s=d[0],e=e+((""==e?"":",")+'"'+("borderThickness"==s?"borderWidth":s)+'":"'+d[1]+("borderThickness"==s||"fontSize"==
s?"px":"")+'"');return"{"+e+"}"}return"{}"}}}(),autorefresh:function(){return{UpdateLayoutSameGroup:function(a,c,e){function b(a,d){function b(f,a){for(var d=0;d<f.Metadata.Parameters.length;d++){var c=f.Metadata.Parameters[d];if(c.IsCollection&&c.Name==a)return[d,c]}return[null,null]}function c(f,a){for(var d=null,b=0;b<f.Parameters.length;b++)if(f.Parameters[b].Name==a){d=f.Parameters[b];break}return d}function e(f,a){for(var d="",b="I"==a.Type||"R"==a.Type||"B"==a.Type?"":'"',c=0;c<f.Filter.Values.length;c++)d+=
(""==d?"":",")+b+f.Filter.Values[c]+b;return"["+d+"]"}var f=[];a._parametersCloned||(a._parametersCloned=!0,a.Parameters=qv.util.cloneObject(a.Parameters));for(var n=qv.util.GetOrderedElementsKeys(a,d),k=a.GetMetadata(),r=0;r<n.length;r++){var u=parseInt(n[r].substr(6,4));sourceElement=d[u];var q=b(a,sourceElement.Name),u=q[0],q=q[1],p=qv.util.GetElementInCollection(k,"Name",sourceElement.Name),y=null!=p,M=!y;y&&(qv.util.MergeFields(sourceElement,p),f.push(p));M&&null!=q&&(q=e(sourceElement,q),a.Object?
(p=eval(a.Object),p[u+2]=q,a.Object=JSON.stringify(p)):(u=c(a,sourceElement.Name),null==u&&(u={},u.Name=sourceElement.Name,a.Parameters.push(u)),u.Value=q))}a.Axes=f}function d(a,d,c){b(a,d);a.RememberLayout=!1;a.AllowElementsOrderChange=c;qv.util.autorefresh.SaveAxesAndParametersState(a);a.realShow()}if(void 0!=a.AutoRefreshGroup&&null!=a.AutoRefreshGroup&&""!=a.AutoRefreshGroup&&""!=qv.util.trim(a.AutoRefreshGroup))for(index in qv.util.autorefresh.DeleteAxesAndParametersState(a),qv.collection)qViewerOther=
qv.collection[index],qv.services.IsObjectSet(qViewerOther)&&(qViewerOther.userControlId()!=a.userControlId()&&a.AutoRefreshGroup==qViewerOther.AutoRefreshGroup)&&(qViewerOther._isAutorefresh=!0,void 0!=qViewerOther.Metadata&&void 0!=qViewerOther.Metadata.Parameters?d(qViewerOther,c,e):qViewerOther.getQueryParameters(function(a,b){var g=qv.util.dom.xmlDocument(a),g=qv.util.dom.getSingleElementByTagName(g,"gxpl_ParameterCollection");void 0==b.Metadata&&(b.Metadata={});b.Metadata.Parameters=[];for(var g=
qv.util.dom.getMultipleElementsByTagName(g,"gxpl_Parameter"),m=0;m<g.length;m++){var o={};o.Name=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(g[m],"Name"));o.Type=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(g[m],"Type"));o.IsCollection=gx.lang.gxBoolean(qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(g[m],"IsCollection")));b.Metadata.Parameters.push(o)}d(b,c,e)}))},LoadAxesAndParametersState:function(a){var c=window.location.pathname+"_"+a.userControlId()+
"_"+a.ObjectId+"_"+a.ObjectName+"_",e=c+"Axes",c=qv.util.storage.getItem(c+"Parameters"),e=qv.util.storage.getItem(e);null!=c&&""!=c&&(a.Parameters=JSON.parse(c),a.RememberLayout=!1);null!=e&&""!=e&&(a.Axes=JSON.parse(e),a.RememberLayout=!1)},SaveAxesAndParametersState:function(a){var c=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",e=c+"Axes";qv.util.storage.setItem(c+"Parameters",JSON.stringify(a.Parameters));qv.util.storage.setItem(e,JSON.stringify(a.Axes))},
DeleteAxesAndParametersState:function(a){var a=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",c=a+"Axes";qv.util.storage.removeItem(a+"Parameters");qv.util.storage.removeItem(c)}}}(),dom:{getSingleElementByTagName:function(a,c){var e;e=this.getMultipleElementsByTagName(a,c);return 0<e.length?e[0]:null},getMultipleElementsByTagName:function(a,c){return!gx.util.browser.isIE()||12<=gx.util.browser.ieVersion()?a.getElementsByTagName(c):a.selectNodes(c)},getBooleanAttribute:function(a,
c,e){a=a.getAttribute(c);return null==a?e:"true"==a.toLowerCase()},getCharacterAttribute:function(a,c,e){a=a.getAttribute(c);return null==a?e:a},getValueNode:function(a){return null==a||void 0==a?null:null!=a.firstChild&&void 0!=a.firstChild?a.firstChild.nodeValue:null},selectXPathNode:function(a,c){var e;a.evaluate?(e=a.evaluate(c,a,null,XPathResult.ANY_TYPE,null),e=e.iterateNext()):(e=a.selectNodes(c),e=0<e.length?e[0]:null);return e},xmlDocument:function(a){var c;!gx.util.browser.isIE()||12<=gx.util.browser.ieVersion()?
(parser=new DOMParser,c=parser.parseFromString(a,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a));return c},getEmptyContainer:function(a){for(a=a.getContainerControl();a.firstChild;)a.removeChild(a.firstChild);return a},setStyle:function(a,c){for(key in c)a.style[key]=c[key]},createText:function(a,c){var e=document.createTextNode(c);a.appendChild(e);return e},createElement:function(a,c,e,b,d,s,v){c=document.createElement(c);""!=e&&(c.id=e);""!=b&&(c.className=b);
qv.util.dom.setStyle(c,d);"function"==typeof s&&(c.onclick=s);""!=v&&qv.util.dom.createText(c,v);null!=a&&a.appendChild(c);return c},createTable:function(a,c,e){a=qv.util.dom.createElement(a,"TABLE","",c,e,null,"");c=document.createElement("TBODY");a.appendChild(c);return c},createRow:function(a){return qv.util.dom.createElement(a,"TR","","",{},null,"")},createCell:function(a,c,e,b,d){a=qv.util.dom.createElement(a,"TD","","",b,null,d);1!=c&&(a.colSpan=c);""!=e&&(a.align=e);return a},createSpan:function(a,
c,e,b,d,s,v){a=qv.util.dom.createElement(a,"SPAN",c,e,d,s,v);""!=b&&(a.title=b);return a},createDiv:function(a,c,e,b,d,s){a=qv.util.dom.createElement(a,"DIV",c,e,d,null,s);""!=b&&(a.title=b);return a},createAnchor:function(a,c,e,b){return qv.util.dom.createElement(a,"A",c,"",e,null,b)},createInput:function(a,c,e,b){a=qv.util.dom.createElement(a,"INPUT",c,"",b,null,"");""!=e&&(a.type=e);return a},createSelect:function(a,c){return qv.util.dom.createElement(a,"SELECT",c,"",{},null,"")},createOption:function(a,
c,e,b){a=qv.util.dom.createElement(a,"OPTION","","",{},null,b);""!=c&&(a.value=c);e&&(a.selected=!0);return a},createIcon:function(a,c,e,b){a=qv.util.dom.createElement(a,"I","","material-icons",e,null,b);""!=c&&(a.title=c);return a}},storage:function(){function a(a,e,b){if(b){var d=new Date;d.setTime(d.getTime()+864E5*b);b="; expires="+d.toGMTString()}else b="";document.cookie=a+"="+e+b+"; path=/"}return{setItem:function(c,e){localStorage?localStorage.setItem(c,e):a(c,e,365)},getItem:function(a){if(localStorage)return localStorage.getItem(a);
a:{for(var a=a+"=",e=document.cookie.split(";"),b=0;b<e.length;b++){for(var d=e[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a)){a=d.substring(a.length,d.length);break a}}a=null}return a},removeItem:function(c){localStorage?localStorage.removeItem(c):a(c,"",-1)}}}(),ExecuteTracker:function(a,c){for(var e=[],b=0;b<gx.fx.ctx.trackers.length;b++)gx.fx.ctx.trackers[b].types[0]==a&&(e[e.length]=gx.fx.ctx.trackers[b]);for(b=0;b<e.length;b++){var d=gx.O;gx.O=e[b].obj;var s=gx.csv.cmpCtx;
gx.csv.cmpCtx=e[b].obj.CmpContext;gx.evt.setProcessing(!1);e[b].hdl.call(e[b].obj,null,null,c);gx.O=d;gx.csv.cmpCtx=s}},satisfyStyle:function(a,c){switch(c.Operator){case QueryViewerConditionOperator.Equal:return a==c.Value1;case QueryViewerConditionOperator.GreaterThan:return a>c.Value1;case QueryViewerConditionOperator.LessThan:return a<c.Value1;case QueryViewerConditionOperator.GreaterOrEqual:return a>=c.Value1;case QueryViewerConditionOperator.LessOrEqual:return a<=c.Value1;case QueryViewerConditionOperator.NotEqual:return a!=
c.Value1;case QueryViewerConditionOperator.Interval:return a>=c.Value1&&a<=c.Value2}},isGeneXusPreview:function(){return IsQueryObjectPreview()},getGenerator:function(){return gx.gen.isDotNet()?"C#":gx.gen.isJava()?"Java":""},getErrorFromText:function(a){return'<Result OK="True"></Result>'==a?"":a.replace('<Result OK="False"><Dsc>',"").replace("</Dsc></Result>","")},trim:function(a){return"string"!=typeof a?null:a.replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ")},capitalize:function(a){return a.charAt(0).toUpperCase()+
a.slice(1)},decapitalize:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},dateToString:function(a,c){var e=a.getStringWithFmt("Y4MD").replace(/\//g,"-");c&&(a.TimeFmt=24,e+=" "+a.getTimeString(!0,!0));return e},cloneObject:function(a){return JSON.parse(JSON.stringify(a))},endsWith:function(a,c){return a.substr(a.length-c.length,c.length)==c},startsWith:function(a,c){return a.substr(0,c.length)==c},formatNumber:function(a,c,e,b){a=gx.num.formatNumber(a,c,e,0,!0,!1);if(b&&(0<=a.indexOf(".")||
0<=a.indexOf(","))){for(;qv.util.endsWith(a,"0");)a=a.slice(0,-1);if(qv.util.endsWith(a,".")||qv.util.endsWith(a,","))a=a.slice(0,-1)}return a},formatDateTime:function(a,c,e,b,d,s,v){a=new gx.date.gxdate(a,"Y4MD");e=a.getStringWithFmt(e);c==QueryViewerDataType.DateTime&&(a.TimeFmt=24,e+=" "+a.getTimeString(d,s,b,v));return e},seconsdToText:function(a){return 60>a?qv.util.formatNumber(Math.round(a),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerSeconds")):3600>a?qv.util.formatNumber(Math.round(a/
60),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerMinutes")):86400>a?qv.util.formatNumber(Math.round(a/60/60),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerHours")):2630016>a?qv.util.formatNumber(Math.round(a/60/60/24),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerDays")):31557600>a?qv.util.formatNumber(Math.round(a/60/60/24/30.44),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerMonths")):
qv.util.formatNumber(Math.round(a/60/60/24/365.25),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerYears"))},ParseNumericPicture:function(a,c){var e,b,d="",s="";if(""==c)e=a==QueryViewerDataType.Integer?0:2,b=!1;else{0>c.indexOf(".")&&0>c.indexOf(",")?(e=0,b=!1):0<=c.indexOf(".")&&0>c.indexOf(",")?(e=a==QueryViewerDataType.Integer?0:c.length-c.indexOf(".")-1,b=!1):(e=0>c.indexOf(".")&&0<=c.indexOf(",")?0:a==QueryViewerDataType.Integer?0:c.length-c.indexOf(".")-1,b=!0);
for(var v=1,g=0;g<c.length;g++){var m=c.substr(g,1);if(("."==m||","==m||"9"==m||"Z"==m)&&1==v)v=2;"."!=m&&(","!=m&&"9"!=m&&"Z"!=m)&&2==v&&(v=3);switch(v){case 1:d+=m;break;case 3:s+=m}}}return{DecimalPrecision:e,UseThousandsSeparator:b,Prefix:d,Suffix:s}},ParseDateTimePicture:function(a,c){var e=gx.dateFormat,b=a==QueryViewerDataType.DateTime,d=a==QueryViewerDataType.DateTime,s=a==QueryViewerDataType.DateTime,v=a==QueryViewerDataType.DateTime;""!=c&&(0<=c.indexOf("9999")&&0>e.indexOf("Y4")?e=e.replace("Y",
"Y4"):0>c.indexOf("9999")&&0<=e.indexOf("Y4")&&(e=e.replace("Y4","Y")),a==QueryViewerDataType.DateTime&&(b=c.indexOf(" "),0<=b?(v=c.substr(b+1,c.length-b),b=2<=v.length,d=5<=v.length,s=8<=v.length,v=12==v.length):v=s=d=b=!1));return{DateFormat:e,IncludeHours:b,IncludeMinutes:d,IncludeSeconds:s,IncludeMilliseconds:v}},evaluate:function(a,c,e){for(var b=1;b<=e.length;b++)a=a.replace(c+b.toString(),e[b-1]);return eval(a)},aggregate:function(a,c,e){var a=a||QueryViewerAggregationType.Sum,b=null,d=null,
s=null,v=null;switch(a){case QueryViewerAggregationType.Sum:for(a=0;a<c.length;a++)null!=c[a]&&(b+=c[a]);return b;case QueryViewerAggregationType.Average:for(a=0;a<c.length;a++)null!=c[a]&&(b+=c[a],d+=e[a]);return null!=b?b/d:null;case QueryViewerAggregationType.Count:for(a=0;a<e.length;a++)d+=e[a];return d;case QueryViewerAggregationType.Max:for(a=0;a<c.length;a++)v=null==v?c[a]:c[a]>v?c[a]:v;return v;case QueryViewerAggregationType.Min:for(a=0;a<c.length;a++)s=null==s?c[a]:c[a]<s?c[a]:s;return s}},
anyError:function(a){return 0==a.indexOf('<Result OK="False"><Dsc>')},showActivityIndicator:function(a){var c='qv.util.showActivityIndicatorMain("'+a.getContainerControl().id+'");',a=a.userControlId();qv.fadeTimeouts[a]&&clearTimeout(qv.fadeTimeouts[a]);qv.fadeTimeouts[a]=setTimeout(c,500)},showActivityIndicatorMain:function(a){a=document.getElementById(a);gx.dom.addClass(a,"gx-qv-loading");for(var c=0;c<a.childNodes.length;c++)gx.dom.addClass(a.childNodes[c],"gx-qv-loading-children")},hideActivityIndicator:function(a){var c=
a.userControlId();qv.fadeTimeouts[c]&&(clearTimeout(qv.fadeTimeouts[c]),qv.fadeTimeouts[c]=void 0);a=a.getContainerControl();gx.dom.removeClass(a,"gx-qv-loading");for(c=0;c<a.childNodes.length;c++)gx.dom.removeClass(a.childNodes[c],"gx-qv-loading-children")},renderError:function(a,c){if(IsQueryObjectPreview()&&!IsDashboardEdit())window.external.SendText(a.ControlName,c);else{var e=qv.util.dom.getEmptyContainer(a);qv.util.dom.createDiv(e,"","gx-qv-centered-text","",{width:gx.dom.addUnits(a.Width),
height:gx.dom.addUnits(a.Height),borderColor:"silver",borderWidth:"thin",borderStyle:"solid"},gx.getMessage("GXPL_QViewerError")+": "+c);a._ControlRenderedTo=void 0;qv.util.hideActivityIndicator(a)}},GetDesigntimeMetadata:function(a){for(var c=[],e=0;e<a.Metadata.Axes.length;e++){var b=a.Metadata.Axes[e];if(!b.IsComponent){var d={};d.Name=b.Name;d.Title=b.Title;d.DataField=b.DataField;d.Visible=b.Visible;d.Type=QueryViewerElementType.Axis;d.Axis=b.Axis;d.Filter=b.Filter;d.ExpandCollapse=b.ExpandCollapse;
d.AxisOrder=b.Order;d.Format={};d.Format.Subtotals=b.Subtotals;d.Format.Picture=b.Picture;d.Format.CanDragToPages=b.CanDragToPages;d.Format.Style=b.Style;0<b.ValuesStyles.length&&(d.Format.ValuesStyles=b.ValuesStyles);d.Actions={};d.Actions.RaiseItemClick=b.RaiseItemClick;c.push(d)}}for(e=0;e<a.Metadata.Data.length;e++)b=a.Metadata.Data[e],b.IsComponent||(d={},d.Name=b.Name,d.Title=b.Title,d.DataField=b.DataField,d.Visible=b.Visible,d.Type=QueryViewerElementType.Datum,d.Axis="",d.Aggregation=b.Aggregation,
d.Format={},d.Format.Picture=b.Picture,d.Format.Style=b.Style,d.Format.TargetValue=b.TargetValue,d.Format.MaximumValue=d.Format.TargetValue,0<b.ConditionalStyles.length&&(d.Format.ConditionalStyles=b.ConditionalStyles),d.Actions={},d.Actions.RaiseItemClick=b.RaiseItemClick,c.push(d));return c},MergeFields:function(a,c){if(c.Visible!=QueryViewerVisible.Never&&(c.Visible=a.Hidden?QueryViewerVisible.No:QueryViewerVisible.Yes,c.Type==QueryViewerElementType.Axis)){c.Axis=a.Axis;if(a.Order)switch(c.AxisOrder.Type){case QueryViewerAxisOrderType.None:case QueryViewerAxisOrderType.Ascending:case QueryViewerAxisOrderType.Descending:c.AxisOrder.Type=
a.Order;break;case QueryViewerAxisOrderType.Custom:a.Order==QueryViewerAxisOrderType.Descending&&c.AxisOrder.Values.reverse()}c.Format.Subtotals!=QueryViewerSubtotals.No&&void 0!=a.Subtotals&&(c.Format.Subtotals=a.Subtotals==QueryViewerSubtotals.Yes?QueryViewerSubtotals.Yes:QueryViewerSubtotals.Hidden);a.Filter&&(c.Filter=a.Filter);a.ExpandCollapse&&(c.ExpandCollapse=a.ExpandCollapse)}},GetOrderedElementsKeys:function(a,c){function e(a,d,f){return Array(d-(""+a).length+1).join(f||"0")+a}for(var b=
[],d=0;d<c.length;d++){var s=c[d],v=a.RealType==QueryViewerOutputType.Table?"0":s.Type==QueryViewerElementType.Axis?"1":"2";if(null!=s.Position){var g;if(a.RealType==QueryViewerOutputType.PivotTable)if(s.Type==QueryViewerElementType.Axis)switch(s.Axis){case QueryViewerAxisType.Columns:g="B";break;case QueryViewerAxisType.Pages:g="C";break;default:g="A"}else g="D";else g="A";v+=g+e(s.Position,4,"0")+e(d,4,"0")}else v+="Z"+e(d,4,"0")+e(d,4,"0");b.push(v)}b.sort();return b},GetContainerControlClass:function(a){return""!=
a.Class?a.Class+"-"+a.RealType.toLowerCase():""},GetContainerControlClasses:function(a){var c=qv.util.GetContainerControlClass(a),e;switch(a.RealType){case QueryViewerOutputType.Card:e="qv-card";break;case QueryViewerOutputType.Chart:e="qv-chart";break;case QueryViewerOutputType.PivotTable:e="qv-pivottable";break;case QueryViewerOutputType.Table:e="qv-table"}""!=c&&(e+=" "+c);return e},SetUserControlClass:function(a,c){a.getContainerControl().className="gx_usercontrol "+c},GetElementInCollection:function(a,
c,e){for(var b=0;b<a.length;b++){var d=a[b];if(d[c]==e)return d}return null},IsInteger:function(a){return Number.isInteger?Number.isInteger(a):"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}};var STATE_DONE=4,STATUS_OK=200;
qv.services=function(){function a(a){return eval(a)[1].replace(/\\/g,".")}function c(a,b){var c=qv.services.RuntimeFieldsJSON(a),g=qv.services.RuntimeParametersJSON(a),e="",o="",f;a:switch(a.RealType){case QueryViewerOutputType.Table:f="IgnoreType";break a;case QueryViewerOutputType.Chart:case QueryViewerOutputType.Card:f="IgnoreTypeAndAxis";break a;default:f="IgnoreNot"}""!=a.QueryInfo&&(o=eval("("+a.QueryInfo+")"),e=o.TextForNullValues,o=gx.json.serializeJson(o.Fields));return a.ObjectName!=b.ObjectName||
a.ObjectType!=b.ObjectType||a.ObjectId!=b.ObjectId||a.Object!=b.Object||c!=b.RuntimeFieldsJSON||g!=b.RuntimeParametersJSON||e!=b.QueryInfoTextForNullValues||o!=b.QueryInfoFieldsJSON||f!=b.MetadataType?(b.ObjectName=a.ObjectName,b.ObjectType=a.ObjectType,b.ObjectId=a.ObjectId,b.Object=a.Object,b.RuntimeFieldsJSON=c,b.RuntimeParametersJSON=g,b.QueryInfoTextForNullValues=e,b.QueryInfoFieldsJSON=o,b.MetadataType=f,!0):!1}function e(a,c){function e(a,f,d){for(var a=b(a),c=0;c<f.length;c++){var n=f[c],
k="";void 0!=n[d]&&(k=n[d].Type);""!=k&&(n=qv.services.postInfo._priv.SdtWithValuesJSON("Order",k,QueryViewerAxisOrderType.Custom,n[d].Values,!1),a+=","+n)}return a}var g=qv.services.RuntimeParametersJSON(a),m=e(a,a.Axes,"AxisOrder"),o="",f="",n="",k=a.RealType==QueryViewerOutputType.Table?"PagedRecordSet":a.RealType==QueryViewerOutputType.PivotTable?"PagedLineSet":"NotPaged";""!=a.QueryInfo&&(n=eval("("+a.QueryInfo+")"),o=n.SQLSentence,f=gx.json.serializeJson(n.Parameters),n=e(a,n.Fields,"Order"));
return a.ObjectName!=c.ObjectName||a.ObjectType!=c.ObjectType||a.ObjectId!=c.ObjectId||a.Object!=c.Object||g!=c.RuntimeParametersJSON||m!=c.OrderJSON||o!=c.QueryInfoSQLSentence||f!=c.QueryInfoParametersJSON||n!=c.QueryInfoOrderJSON||k!=c.DataType?(c.ObjectName=a.ObjectName,c.ObjectType=a.ObjectType,c.ObjectId=a.ObjectId,c.Object=a.Object,c.RuntimeParametersJSON=g,c.OrderJSON=m,c.QueryInfoSQLSentence=o,c.QueryInfoParametersJSON=f,c.QueryInfoOrderJSON=n,c.DataType=k,!0):!1}function b(a){return a.RealType==
QueryViewerOutputType.Chart&&qv.chart.IsDatetimeXAxis(a)||a.RealType==QueryViewerOutputType.Card&&(a.IncludeSparkline||a.IncludeTrend)}return{url:function(){function a(b,d){var c=qv.util.getGenerator(),e;e=(new Date).getTime();var o=b.enableServerDebug?"_debug":"";switch(c){case "C#":var c=new gx.util.Url(location.href),f=c.path,f=f.substr(0,f.lastIndexOf("/")+1);urlresult=""==c.port?c.protocol+"://"+c.host+f:c.protocol+"://"+c.host+":"+c.port+f;return urlresult+"agxpl_get"+o+".aspx?"+d+","+e;case "Java":return gx.util.resourceUrl(gx.basePath,
!0)+"qviewer.services.agxpl_get"+o+"?"+d+","+e;default:return""}}return{getDefaultOutputURL:function(b){return a(b,"defaultoutput")},getRecordsetCacheKeyURL:function(b){return a(b,"recordsetcachekey")},getMetadataURL:function(b){return a(b,"metadata")},getDataURL:function(b){return a(b,"data")},getAttributeValuesURL:function(b){return a(b,"attributevalues")},getPageDataForTableURL:function(b){return a(b,"pagedatafortable")},getPageDataForPivotTableURL:function(b){return a(b,"pagedataforpivottable")},
getQueryParametersURL:function(b){return a(b,"queryparameters")},getDashboardSpecURL:function(b){return a(b,"dashboardspec")}}}(),postInfo:function(){function d(a,b){var d="",g,e,v,m,o,M,D,R,A,l,E;g=!1;for(i=0;void 0!=a.Axes[i];i++){g=!0;d+=""!=d?",":"";d+="{";e="";m=v=0;M=o="";R=D=!0;E=l=A="";var B;B=a.Axes[i];var z="",x=!1;if(void 0!=B.Format&&void 0!=B.Format.ValuesStyles)for(var t=0;void 0!=B.Format.ValuesStyles[t];t++)x=!0,z+=""!=z?",":"",z+="{",z+='"Value":"'+encodeURIComponent(B.Format.ValuesStyles[t].Value)+
'"',z+=",",z+='"Style":"'+encodeURIComponent(B.Format.ValuesStyles[t].StyleOrClass)+'"',z+=",",z+='"Propagate":'+(B.Format.ValuesStyles[t].ApplyToRowOrColumn?"true":"false"),z+="}";x&&(z='"ValuesStyles":['+z+"]");B=z;z=a.Axes[i];x="";t=!1;if(void 0!=z.Format&&void 0!=z.Format.ConditionalStyles)for(var N=0;void 0!=z.Format.ConditionalStyles[N];N++)t=!0,x+=""!=x?",":"",x+="{",x+='"Operator":"'+z.Format.ConditionalStyles[N].Operator+'"',x+=",",x+='"Value1":"'+encodeURIComponent(z.Format.ConditionalStyles[N].Value1)+
'"',z.Format.ConditionalStyles[N].Operator==QueryViewerConditionOperator.Interval&&(x+=",",x+='"Value2":"'+encodeURIComponent(z.Format.ConditionalStyles[N].Value2)+'"'),x+=",",x+='"Style":"'+encodeURIComponent(z.Format.ConditionalStyles[N].StyleOrClass)+'"',x+="}";t&&(x='"ConditionalStyles":['+x+"]");z=x;x=a.Axes[i];t="";void 0!=x.Grouping&&(t+="{",t+='"GroupByYear":'+(x.Grouping.GroupByYear?"true":"false"),t+=",",t+='"YearTitle":"'+x.Grouping.YearTitle+'"',t+=",",t+='"GroupBySemester":'+(x.Grouping.GroupBySemester?
"true":"false"),t+=",",t+='"SemesterTitle":"'+x.Grouping.SemesterTitle+'"',t+=",",t+='"GroupByQuarter":'+(x.Grouping.GroupByQuarter?"true":"false"),t+=",",t+='"QuarterTitle":"'+x.Grouping.QuarterTitle+'"',t+=",",t+='"GroupByMonth":'+(x.Grouping.GroupByMonth?"true":"false"),t+=",",t+='"MonthTitle":"'+x.Grouping.MonthTitle+'"',t+=",",t+='"GroupByDayOfWeek":'+(x.Grouping.GroupByDayOfWeek?"true":"false"),t+=",",t+='"DayOfWeekTitle":"'+x.Grouping.DayOfWeekTitle+'"',t+=",",t+='"HideValue":'+(x.Grouping.HideValue?
"true":"false"),t+="}",t='"Grouping":'+t);x=t;void 0!=a.Axes[i].Format&&(e=a.Axes[i].Format.Picture?a.Axes[i].Format.Picture:"",v=a.Axes[i].Format.TargetValue?a.Axes[i].Format.TargetValue:0,m=a.Axes[i].Format.MaximumValue?a.Axes[i].Format.MaximumValue:0,o=a.Axes[i].Format.Style?a.Axes[i].Format.Style:"",M=a.Axes[i].Format.Subtotals?a.Axes[i].Format.Subtotals:"",D=void 0!=a.Axes[i].Format.CanDragToPages?a.Axes[i].Format.CanDragToPages:!0);void 0!=a.Axes[i].Actions&&(R=a.Axes[i].Actions.RaiseItemClick);
void 0!=a.Axes[i].AxisOrder&&(A=a.Axes[i].AxisOrder.Type);void 0!=a.Axes[i].ExpandCollapse&&(l=a.Axes[i].ExpandCollapse.Type);void 0!=a.Axes[i].Filter&&(E=a.Axes[i].Filter.Type);void 0==E&&(E=QueryViewerFilterType.ShowSomeValues);d+='"Name":"'+encodeURIComponent(a.Axes[i].Name)+'"';d+=",";d+='"Caption":"'+encodeURIComponent(a.Axes[i].Title)+'"';d+=",";d+='"Aggregation":"'+a.Axes[i].Aggregation+'"';d+=",";d+='"Visible":"'+a.Axes[i].Visible+'"';d+=",";d+='"Type":"'+a.Axes[i].Type+'"';d+=",";d+='"Axis":"'+
a.Axes[i].Axis+'"';d+=",";d+='"Picture":"'+encodeURIComponent(e)+'"';d+=",";d+='"TargetValue":'+v;d+=",";d+='"MaximumValue":'+m;d+=",";d+='"Style":"'+o+'"';d+=",";d+='"Subtotals":"'+M+'"';d+=",";d+='"CanDragToPages":'+D;d+=",";d+='"RaiseItemClick":'+R;""!=A&&(e=c("Order",A,QueryViewerAxisOrderType.Custom,a.Axes[i].AxisOrder.Values,b),d+=""!=e?","+e:"");""!=l&&(l=c("ExpandCollapse",l,QueryViewerExpandCollapseType.ExpandSomeValues,a.Axes[i].ExpandCollapse.Values,b),d+=""!=l?","+l:"");""!=E&&a.Axes[i].Filter.Values&&
(E=c("Filter",E,QueryViewerFilterType.ShowSomeValues,a.Axes[i].Filter.Values,b),d+=""!=E?","+E:"");d+=""!=B?","+B:"";d+=""!=z?","+z:"";d+=""!=x?","+x:"";d+="}"}g&&(d='"RuntimeFields":['+d+"]");return d}function c(a,d,b,e,g){var s="";if(""!=d){s=s+('"'+a+'":')+"{"+('"Type":"'+d+'"');strValues="";if(d==b){existValues=!1;for(j=0;void 0!=e[j];j++)existValues=!0,strValues+=""!=strValues?",":"",strValues=g?strValues+('"'+encodeURIComponent(e[j])+'"'):strValues+('"'+e[j]+'"');existValues&&(strValues=',"Values":['+
strValues+"]")}s+=strValues;s+="}"}return s}function e(a){var d="",b=!1;if(a.Object){a=eval(a.Object);for(i=2;i<a.length;i++)b=!0,d+=""!=d?",":"",d+="{",d+='"Value":"'+encodeURIComponent(a[i])+'"',d+="}"}else for(i=0;void 0!=a.Parameters[i];i++)b=!0,d+=""!=d?",":"",d+="{",d+='"Name":"'+a.Parameters[i].Name+'"',d+=",",d+='"Value":"'+encodeURIComponent(a.Parameters[i].Value)+'"',d+="}";b&&(d='"RuntimeParameters":['+d+"]");return d}function g(a){var d="",b=!1;for(i=0;void 0!=a[i];i++){b=!0;d+=""!=d?
",":"";d+="{";d+='"DataField":"'+a[i].DataField+'"';d+=",";d+='"NullIncluded":'+a[i].NullIncluded;strIncludedValues="";existValues=!1;for(j=0;void 0!=a[i].NotNullValues.Included[j];j++)existValues=!0,strIncludedValues+=""!=strIncludedValues?",":"",strIncludedValues+='"'+encodeURIComponent(a[i].NotNullValues.Included[j])+'"';existValues&&(strIncludedValues=',"Included":['+strIncludedValues+"]");strExcludedValues="";existValues=!1;for(j=0;void 0!=a[i].NotNullValues.Excluded[j];j++)existValues=!0,strExcludedValues+=
""!=strExcludedValues?",":"",strExcludedValues+='"'+encodeURIComponent(a[i].NotNullValues.Excluded[j])+'"';existValues&&(strExcludedValues=',"Excluded":['+strExcludedValues+"]");d+=",";d+='"NotNullValues":{"DefaultAction":"'+a[i].NotNullValues.DefaultAction+'"'+strIncludedValues+strExcludedValues+"}";d+="}"}b&&(d='"Filters":['+d+"]");return d}function m(a){return a.UseRecordsetCache?'{"ActualKey":"'+a.RecordsetCache.ActualKey+'","OldKey":"'+a.RecordsetCache.OldKey+'","MinutesToKeep":'+a.MinutesToKeepInRecordsetCache+
',"MaximumSize":'+a.MaximumCacheSize+"}":'{"ActualKey":"","OldKey":"","MinutesToKeep":0,"MaximumSize":0}'}function o(d){var b;b=""+(""!=d.ParentObject.PackageName?'"ApplicationNamespace":"'+d.ParentObject.PackageName+'",':"");d.Object?b+='"ObjectName":"'+a(d.Object)+'"':(b+='"ObjectName":"'+d.ObjectName+'"',b=b+","+('"Alt_ObjectType":"'+d.ObjectType+'"'),b=b+","+('"Alt_ObjectId":'+d.ObjectId));return b}return{DefaultOutput:function(a){var d;d="{"+o(a);d+=""!=a.ObjectInfo?',"ObjectInfo":'+a.ObjectInfo:
"";return"Data="+encodeURIComponent(d+"}")},RecordsetCacheKey:function(a){a="{"+o(a);return"Data="+encodeURIComponent(a+"}")},Metadata:function(a){var b="",c=e(a),g=d(a,!0),b=b+"{"+o(a),b=b+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),b=b+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),b=b+(""!=c?","+c:"")+(""!=g?","+g:"")+","+('"OutputType":"'+a.RealType+'"'),b=b+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),b=b+","+('"RememberLayout":'+a.RememberLayout),b=b+","+('"ShowDataLabelsIn":"'+
a.ShowDataLabelsIn+'"'),b=b+","+('"RecordsetCacheInfo":'+m(a)),b=b+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(b+"}")},Data:function(a){var c="",g=e(a),s=d(a,!0),c=c+"{"+o(a),c=c+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),c=c+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),c=c+(""!=g?","+g:"")+(""!=s?","+s:"")+","+('"OutputType":"'+a.RealType+'"'),c=c+","+('"SortAscendingForced":'+b(a)),c=c+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),
c=c+","+('"RecordsetCacheInfo":'+m(a)),c=c+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(c+"}")},AttributeValues:function(a,b,c,g,s){var q="",p=e(a),y=d(a,!0),q=q+"{"+o(a),q=q+","+('"DataField":"'+b+'"')+","+('"PageNumber":'+c)+","+('"PageSize":'+g)+","+('"Filter":"'+s+'"')+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),q=q+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),q=q+(""!=p?","+p:"")+(""!=y?","+y:"")+","+('"OutputType":"'+a.RealType+'"'),q=q+","+
('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),q=q+","+('"RecordsetCacheInfo":'+m(a)),q=q+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(q+"}")},TablePageData:function(a,b,c,s,u,q,p){var y="",M=e(a),D=d(a,!0),p=g(p),y=y+"{"+o(a),y=y+","+('"PageNumber":'+b)+","+('"PageSize":'+(gx.lang.gxBoolean(a.Paging)?c:0)),y=y+","+('"ReturnTotPages":'+s)+","+('"Order":'+('{"DataField":"'+u+'","Type":"'+q+'"}'))+(""!=p?","+p:"")+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:
""),y=y+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),y=y+(""!=M?","+M:"")+(""!=D?","+D:"")+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),y=y+","+('"RecordsetCacheInfo":'+m(a)),y=y+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(y+"}")},PivotTablePageData:function(a,b,c,s,u,q,p,y,M){for(var D="",R=e(a),A=d(a,!0),l="",E=!1,B=0;void 0!=u[B];B++)E=!0,l+=""!=l?",":"",l+="{",l+='"DataField":"'+u[B].DataField+'"',l+=",",l+='"Visible":'+!u[B].Hidden,
l+=",",l+='"Axis":"'+u[B].Axis.Type+'"',l+=",",l+='"Position":'+(qv.util.IsInteger(u[B].Axis.Position)?u[B].Axis.Position:0),l+=",",l+='"Order":"'+u[B].Order+'"',l+=",",l+='"Subtotals":'+u[B].Subtotals,l+="}";E&&(l='"AxesInfo":['+l+"]");u=l;l="";E=!1;for(B=0;void 0!=q[B];B++)E=!0,l+=""!=l?",":"",l+="{",l+='"DataField":"'+q[B].DataField+'"',l+=",",l+='"Visible":'+!q[B].Hidden,l+=",",l+='"Position":'+(qv.util.IsInteger(q[B].Position)?q[B].Position:0),l+="}";E&&(l='"DataInfo":['+l+"]");q=l;p=g(p);l=
"";E=!1;for(B=0;void 0!=y[B];B++){E=!0;l+=""!=l?",":"";l+="{";l+='"DataField":"'+y[B].DataField+'"';l+=",";l+='"NullExpanded":'+y[B].NullExpanded;strExpandedValues="";existValues=!1;for(var z=0;void 0!=y[B].NotNullValues.Expanded[z];z++)existValues=!0,strExpandedValues+=""!=strExpandedValues?",":"",strExpandedValues+='"'+encodeURIComponent(y[B].NotNullValues.Expanded[z])+'"';existValues&&(strExpandedValues=',"Expanded":['+strExpandedValues+"]");strCollapsedValues="";existValues=!1;for(z=0;void 0!=
y[B].NotNullValues.Collapsed[z];z++)existValues=!0,strCollapsedValues+=""!=strCollapsedValues?",":"",strCollapsedValues+='"'+encodeURIComponent(y[B].NotNullValues.Collapsed[z])+'"';existValues&&(strCollapsedValues=',"Collapsed":['+strCollapsedValues+"]");l+=",";l+='"NotNullValues":{"DefaultAction":"'+y[B].NotNullValues.DefaultAction+'"'+strExpandedValues+strCollapsedValues+"}";l+="}"}E&&(l='"ExpandCollapse":['+l+"]");y=l;D=D+"{"+o(a);D=D+","+('"PageNumber":'+b)+","+('"PageSize":'+(gx.lang.gxBoolean(a.Paging)?
c:0));D=D+","+('"ReturnTotPages":'+s)+","+('"ShowDataLabelsIn":"'+a.ShowDataLabelsIn+'"');D=D+(""!=u?","+u:"")+(""!=q?","+q:"")+(""!=p?","+p:"")+(""!=y?","+y:"")+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:"");D+=""!=a.AppSettings?',"AppSettings":'+a.AppSettings:"";D=D+(""!=R?","+R:"")+(""!=A?","+A:"")+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange);D=D+","+('"RecordsetCacheInfo":'+m(a));D=D+","+('"LayoutChanged":'+M)+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(D+
"}")},getQueryParameters:function(a){var d;d="{"+o(a);d+=""!=a.ObjectInfo?',"ObjectInfo":'+a.ObjectInfo:"";return"Data="+encodeURIComponent(d+"}")},DashboardSpec:function(d){var b="";d.Object&&(b=a(d.Object));d=JSON.stringify({ApplicationNamespace:d.ParentObject.PackageName,ObjectName:b,Alt_ObjectId:0});return"Data="+encodeURIComponent(d)},_priv:{RuntimeParametersJSON:function(a){return e(a)},RuntimeFieldsJSON:function(a){return d(a)},SdtWithValuesJSON:function(a,d,b,g,e){return c(a,d,b,g,e)}}}}(),
RuntimeParametersJSON:function(a){return this.postInfo._priv.RuntimeParametersJSON(a)},RuntimeFieldsJSON:function(a,b){return this.postInfo._priv.RuntimeFieldsJSON(a,b)},getXMLHttpRequest:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){return null}},CallServerSync:function(a,b,c,g){g=g||[];g.unshift(a);a=b.call(qv.services.url,a);c=c.apply(qv.services.postInfo,g);g=qv.services.getXMLHttpRequest();g.open("POST",a,!1);
g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");g.send(c);return g.responseText},createAsyncServerCallFn:function(a,b,c,g,e){return function(o,f){f=f||[];f.unshift(a);var n=function(b){e&&a.RealType!=QueryViewerOutputType.Card&&(b=e.call(qv.util.css,b));o(b,a)};if(gx.lang.gxBoolean(a.IsExternalQuery))n(a.ExternalQueryResultObj()[g]);else{var k=b.call(qv.services.url,a),r=c.apply(qv.services.postInfo,f),u=qv.services.getXMLHttpRequest(),q=function(){u.readyState==STATE_DONE&&
u.status==STATUS_OK&&n(u.responseText)};gx.util.browser.isIE()?u.onreadystatechange=q:u.onload=q;u.open("POST",k);u.setRequestHeader("Content-Type","application/x-www-form-urlencoded");u.send(r)}}},parseRecordsetCacheKeyXML:function(a){""!=a.xml.recordsetCacheKey&&(a.RecordsetCache=a.RecordsetCache||{},a.RecordsetCache.OldKey=a.RecordsetCache.ActualKey?a.RecordsetCache.ActualKey:"",a.RecordsetCache.ActualKey=a.xml.recordsetCacheKey)},parseDataXML:function(a){if(""!=a.xml.data){var b=qv.util.dom.xmlDocument(a.xml.data),
b=qv.util.dom.getSingleElementByTagName(b,"Recordset");a.Data=a.Data||{};b=gx.util.browser.isIE()?qv.util.dom.getMultipleElementsByTagName(qv.util.dom.getSingleElementByTagName(b,"Page"),"Record"):qv.util.dom.getMultipleElementsByTagName(b,"Record");a.Data.Rows=[];for(var c=0;c<b.length;c++){for(var g={},e=0;e<b[c].childNodes.length;e++){var o=b[c].childNodes[e];1==o.nodeType&&(g[o.nodeName]=1==o.childNodes.length?o.childNodes[0].nodeValue:"")}a.Data.Rows.push(g)}}},parseMetadataXML:function(a){function b(a,
d){if("greaterequal"==a&&"lessequal"==d)return QueryViewerConditionOperator.Interval;switch(a){case "equal":return QueryViewerConditionOperator.Equal;case "less":return QueryViewerConditionOperator.LessThan;case "greater":return QueryViewerConditionOperator.GreaterThan;case "lessequal":return QueryViewerConditionOperator.LessOrEqual;case "greaterequal":return QueryViewerConditionOperator.GreaterOrEqual;case "notequal":return QueryViewerConditionOperator.NotEqual}}function c(a,b,d,f){var e={},a=qv.util.dom.getSingleElementByTagName(a,
b);if(null!=a){e.GroupFound=!0;e.TotalValueFound=!1;d=qv.util.dom.getMultipleElementsByTagName(a,d);e.Values=[];for(a=0;a<d.length;a++)b=null!=d[a].firstChild?d[a].firstChild.nodeValue:"","TOTAL"==b&&f?e.TotalValueFound=!0:e.Values.push(b)}else e.GroupFound=!1;return e}function e(a){if(0==a.indexOf("gxpl_cssReplace("))var b=a.indexOf("gxpl_cssReplace("),d=a.indexOf(")",b),a=a.substring(b+16,d);return a}function m(a){for(var a=qv.util.dom.getSingleElementByTagName(a,"formatValues"),a=null!=a?qv.util.dom.getMultipleElementsByTagName(a,
"value"):[],b=[],d=0;d<a.length;d++){var c={};c.Value=qv.util.trim(null!=a[d].firstChild?a[d].firstChild.nodeValue:"");c.StyleOrClass=e(a[d].getAttribute("format"));c.ApplyToRowOrColumn="yes"==a[d].getAttribute("recursive");b.push(c)}return b}function o(a){for(var a=qv.util.dom.getSingleElementByTagName(a,"conditionalFormats"),a=null!=a?qv.util.dom.getMultipleElementsByTagName(a,"rule"):[],d=[],c=0;c<a.length;c++){var f={};f.Operator=b(a[c].getAttribute("op1"),a[c].getAttribute("op2"));f.Value1=parseFloat(a[c].getAttribute("value1"));
f.Operator==QueryViewerConditionOperator.Interval&&(f.Value2=parseFloat(a[c].getAttribute("value2")));f.StyleOrClass=e(a[c].getAttribute("format"));d.push(f)}return d}if(""!=a.xml.metadata){var f=qv.util.dom.xmlDocument(a.xml.metadata),n=qv.util.dom.getSingleElementByTagName(f,"OLAPCube");a.Metadata=a.Metadata||{};a.Metadata.TextForNullValues=n.getAttribute("textForNullValues");var k=qv.util.dom.getMultipleElementsByTagName(n,"OLAPDimension");a.Metadata.Axes=[];for(f=0;f<k.length;f++){var r={};r.Name=
k[f].getAttribute("name");r.Title=k[f].getAttribute("displayName");r.DataField=k[f].getAttribute("dataField");r.DataType=k[f].getAttribute("dataType");r.Visible=k[f].getAttribute("visible");r.Axis=k[f].getAttribute("axis");r.Picture=k[f].getAttribute("picture");if(""==r.Picture)switch(r.DataType){case QueryViewerDataType.Integer:r.Picture="ZZZZZZZZZZZZZZ9";break;case QueryViewerDataType.Real:r.Picture="ZZZZZZZZZZZZZZ9.99";break;case QueryViewerDataType.Date:r.Picture="99/99/9999";break;case QueryViewerDataType.DateTime:r.Picture=
"99/99/9999 99:99:99";break;case QueryViewerDataType.GUID:r.Picture="XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"}r.CanDragToPages=qv.util.dom.getBooleanAttribute(k[f],"canDragToPages",!0);r.RaiseItemClick=qv.util.dom.getBooleanAttribute(k[f],"raiseItemClick",!0);r.IsComponent=qv.util.dom.getBooleanAttribute(k[f],"isComponent",!1);r.Style=k[f].getAttribute("format");var u=c(k[f],"include","value",!0),q=c(k[f],"exclude","value",!0),p=c(k[f],"expand","value",!1),y=c(k[f],"customOrder","Value",!1);r.Subtotals=
"no"==k[f].getAttribute("summarize")?QueryViewerSubtotals.No:q.GroupFound&&q.TotalValueFound?QueryViewerSubtotals.Hidden:QueryViewerSubtotals.Yes;r.Filter={};!u.GroupFound&&!q.GroupFound?(r.Filter.Type=QueryViewerFilterType.ShowAllValues,r.Filter.Values=[]):!u.GroupFound&&q.GroupFound&&0==q.Values.length&q.TotalValueFound?(r.Filter.Type=QueryViewerFilterType.ShowAllValues,r.Filter.Values=[]):u.GroupFound&&!q.GroupFound&&0==u.Values.length?(r.Filter.Type=QueryViewerFilterType.HideAllValues,r.Filter.Values=
[]):(r.Filter.Type=QueryViewerFilterType.ShowSomeValues,r.Filter.Values=u.Values);r.ExpandCollapse={};p.GroupFound?p.GroupFound&&0==p.Values.length?(r.ExpandCollapse.Type=QueryViewerExpandCollapseType.CollapseAllValues,r.ExpandCollapse.Values=[]):(r.ExpandCollapse.Type=QueryViewerExpandCollapseType.ExpandSomeValues,r.ExpandCollapse.Values=p.Values):(r.ExpandCollapse.Type=QueryViewerExpandCollapseType.ExpandAllValues,r.ExpandCollapse.Values=[]);r.Order={};u=k[f].getAttribute("order");null==u?(r.Order.Type=
QueryViewerAxisOrderType.None,r.Order.Values=[]):(r.Order.Type=qv.util.capitalize(u),r.Order.Values=r.Order.Type==QueryViewerAxisOrderType.Custom?y.Values:[]);r.ValuesStyles=m(k[f]);a.Metadata.Axes.push(r)}n=qv.util.dom.getMultipleElementsByTagName(n,"OLAPMeasure");a.Metadata.Data=[];for(f=0;f<n.length;f++)k={},k.Name=n[f].getAttribute("name"),k.Title=n[f].getAttribute("displayName"),k.DataField=n[f].getAttribute("dataField"),k.Aggregation=n[f].getAttribute("aggregation"),k.DataType=n[f].getAttribute("dataType"),
k.Visible=n[f].getAttribute("visible"),k.Picture=n[f].getAttribute("picture"),k.RaiseItemClick=qv.util.dom.getBooleanAttribute(n[f],"raiseItemClick",!0),k.IsComponent=qv.util.dom.getBooleanAttribute(n[f],"isComponent",!1),""==k.Picture&&(k.Picture=k.DataType==QueryViewerDataType.Integer?"ZZZZZZZZZZZZZZ9":"ZZZZZZZZZZZZZZ9.99"),k.Aggregation=qv.util.capitalize(k.Aggregation),k.TargetValue=parseFloat(n[f].getAttribute("targetValue")),k.MaximumValue=parseFloat(n[f].getAttribute("maximumValue")),k.Style=
n[f].getAttribute("format"),0>=k.TargetValue&&(k.TargetValue=100),0>=k.MaximumValue&&(k.MaximumValue=100),k.ConditionalStyles=o(n[f]),r=qv.util.dom.getCharacterAttribute(n[f],"formula",""),k.IsFormula=""!=r,k.Formula=r,a.Metadata.Data.push(k)}},GetDataIfNeeded:function(a,b){a.Data=a.Data||{};a.Data.LastServiceCallKey=a.Data.LastServiceCallKey||{};void 0==a.xml.data||e(a,a.Data.LastServiceCallKey)||gx.lang.gxBoolean(a.IsExternalQuery)?a.calculatePivottableData(b):b(a.xml.data,a)},GetMetadataIfNeeded:function(a,
b){a.Metadata=a.Metadata||{};a.Metadata.LastServiceCallKey=a.Metadata.LastServiceCallKey||{};void 0==a.xml.metadata||c(a,a.Metadata.LastServiceCallKey)||gx.lang.gxBoolean(a.IsExternalQuery)?a.calculatePivottableMetadata(b):b(a.xml.metadata,a)},GetDashboardSpecIfNeeded:function(b,c){b.DashboardSpec=b.DashboardSpec||"";b.LastServiceCallKey=b.LastServiceCallKey||{};var e;if(!(e=void 0==b.DashboardSpec))if(e=b.LastServiceCallKey,b.Object){var g=a(b.Object);g!=e.ObjectName?(e.ObjectName=g,e=!0):e=!1}else e=
""==b.DashboardSpec;e?(b.LoadingSpec=!0,b.GetDashboardSpec(c)):c(b.DashboardSpec,b)},GetRecordsetCacheKeyIfNeeded:function(a,b){a.UseRecordsetCache&&!gx.lang.gxBoolean(a.IsExternalQuery)?(a.RecordsetCache=a.RecordsetCache||{},a.RecordsetCache.LastServiceCallKey=a.RecordsetCache.LastServiceCallKey||{},void 0==a.xml.recordsetCacheKey||e(a,a.RecordsetCache.LastServiceCallKey)?a.getRecordsetCacheKey(b):b(a.xml.recordsetCacheKey,a)):b("",a)},IsObjectSet:function(a){return a.Object||""!=a.ObjectName||""!=
a.ObjectType&&0!=a.ObjectId}}}();
qv.pivot=function(){function a(a){var d=qv.util.GetContainerControlClasses(a);""!=d&&qv.util.SetUserControlClass(a,d);d=a.userControlId()+"_"+a.ObjectName.replace(/,/g,"").replace(/\./g,"")+"_pivot_page";a.pivotParams={};a.pivotParams.page=d;var c=a.userControlId()+"_"+a.ObjectName.replace(/,/g,"").replace(/\./g,"")+"_pivot_content";a.pivotParams.content=c;if(a._ControlRenderedTo!=a.RealType||0==jQuery("#"+c).length)if(a._ControlRenderedTo!=a.RealType&&a.RealType==QueryViewerOutputType.PivotTable){var e=
qv.util.dom.getEmptyContainer(a);qv.util.dom.createDiv(e,d,"","",{},"");qv.util.dom.createDiv(e,c,"","",{},"")}else jQuery("#"+a.ContainerName).find(".pivot_filter_div").attr("id",d),jQuery("#"+a.ContainerName).find(".conteiner_table_div").attr("id",c);a.pivotParams.container=a.getContainerControl();a.pivotParams.RealType=a.RealType;a.pivotParams.ObjectName=a.ObjectName;a.pivotParams.ControlName=a.ControlName;a.pivotParams.PageSize=a.Paging&&"false"!=a.Paging?a.PageSize:void 0;a.pivotParams.metadata=
a.xml.metadata;d=gx.lang.gxBoolean(a.IsExternalQuery)?a.xml.data:a.RealType==QueryViewerOutputType.Table?a.ServerPagingForTable?a.xml.pageData:a.xml.data:a.ServerPagingForPivotTable?a.xml.pageData:a.xml.data;a.pivotParams.data=d;a.pivotParams.UcId=a.userControlId();a.pivotParams.AutoResize=gx.lang.gxBoolean(a.AutoResize)||gx.lang.gxBoolean(a.ShrinkToFit);a.pivotParams.DisableColumnSort=a.DisableColumnSort;a.pivotParams.RememberLayout=a.RememberLayout;a.pivotParams.ShowDataLabelsIn=a.ShowDataLabelsIn;
a.pivotParams.ServerPaging=a.ServerPagingForTable&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.ServerPagingPivot=a.ServerPagingForPivotTable&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.ServerPagingCacheSize=0;a.pivotParams.UseRecordsetCache=a.UseRecordsetCache&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.AllowSelection=a.AllowSelection;a.pivotParams.SelectLine=!0;void 0!=OAT.Loader?renderJSPivot(a.pivotParams,qv.collection,a):OAT.Loader.addListener(function(){renderJSPivot(a.pivotParams,
qv.collection,a)});a._ControlRenderedTo=a.RealType;a.RealType==QueryViewerOutputType.Table&&qv.util.hideActivityIndicator(a)}function c(b){b.getPageDataForTable(function(b,c){(new Date).getTime();qv.util.anyError(b)?(errMsg=qv.util.getErrorFromText(b),qv.util.renderError(c,errMsg)):(""!=b&&(c.xml.pageData=b),a(c))},[1,b.PageSize,!0,"","",[]])}function e(a,d){var c=[];if(null!=a)for(var e=-1,g=0;g<a.childNodes.length;g++)if("ITEM"==a.childNodes[g].nodeName){var m=a.childNodes[g].getAttribute("name");
if(0>d.indexOf(m)){e++;c[e]={};c[e].Name=m;c[e].Values=[];for(var m=-1,o=a.childNodes[g],f=0;f<a.childNodes[g].childNodes.length;f++)if("VALUES"==a.childNodes[g].childNodes[f].nodeName){o=a.childNodes[g].childNodes[f];break}for(f=0;f<o.childNodes.length;f++)"VALUE"==o.childNodes[f].nodeName&&(m++,c[e].Values[m]=null!=o.childNodes[f].firstChild?o.childNodes[f].firstChild.nodeValue:"")}}return c}return{tryToRenderPivotTable:function(b){var d="",e=(new Date).getTime();b.xml=b.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(b,
function(b,g){var m=!1;b!=g.xml.recordsetCacheKey&&(g.xml.recordsetCacheKey=b,m=!0);qv.util.anyError(b)?(d=qv.util.getErrorFromText(b),qv.util.renderError(g,d)):(m&&qv.services.parseRecordsetCacheKeyXML(g),qv.services.GetMetadataIfNeeded(g,function(b,f){var g=false;if(b!=f.xml.metadata){f.xml.metadata=b;g=true}var k=(new Date).getTime();if(qv.util.anyError(b)){d=qv.util.getErrorFromText(b);qv.util.renderError(f,d)}else{g&&qv.services.parseMetadataXML(f);if(f.ServerPagingForTable&&f.RealType==QueryViewerOutputType.Table&&
!gx.lang.gxBoolean(f.IsExternalQuery)){g=false;OAT.getStateWhenServingPaging&&(g=OAT.getStateWhenServingPaging(f.userControlId()+"_"+f.ObjectName,f.ObjectName));!g||!f.RememberLayout?c(f,e,k):a(f)}else if(f.ServerPagingForPivotTable&&f.RealType==QueryViewerOutputType.PivotTable&&!gx.lang.gxBoolean(f.IsExternalQuery)){g=false;OAT.getStateWhenServingPaging&&(g=OAT.getStateWhenServingPaging(f.userControlId()+"_"+f.ObjectName,f.ObjectName));a(f)}else qv.services.GetDataIfNeeded(f,function(b,c){if(b!=
c.xml.data)c.xml.data=b;(new Date).getTime();if(qv.util.anyError(b)){d=qv.util.getErrorFromText(b);qv.util.renderError(c,d)}else a(c)})}}))})},GetMetadataPivot:function(a){var d=qv.util.GetDesigntimeMetadata(a);if(0<d.length){for(var c=a.oat_element.getMetadataXML(),c=qv.pivot.GetRuntimeMetadata(c,a.RealType),e=[],a=qv.util.GetOrderedElementsKeys(a,c),g=0;g<a.length;g++)for(var m=parseInt(a[g].substr(6,4)),m=c[m],o,f=0;f<d.length;f++)if(o=d[f],o.Name==m.Name){o=qv.util.cloneObject(o);qv.util.MergeFields(m,
o);e.push(o);break}return e}return[]},GetRuntimeMetadata:function(a,d){function c(a,b,d,f,e){var b=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(a,b)),g=[];if(b==f&&(a=qv.util.dom.getSingleElementByTagName(a,d),null!=a)){a=qv.util.dom.getMultipleElementsByTagName(a,"value");for(d=0;d<a.length;d++)f=qv.util.trim(qv.util.dom.getValueNode(a[d])),null!=f&&("TOTAL"!=f.toUpperCase()||!e)&&g.push(f)}return{Type:b,Values:g}}var e=qv.util.dom.xmlDocument(a),e=qv.util.dom.getSingleElementByTagName(e,
"OLAPCube"),g=[],m;m=qv.util.dom.getMultipleElementsByTagName(e,"OLAPDimension");for(var o=0;o<m.length;o++){var f={},n=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"name")),k="true"==qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"hidden")),r=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"axis")),u=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"position")),q=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],
"summarize")),p=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"order"));f.Name=n;f.Type=QueryViewerElementType.Axis;f.Hidden=k;f.Axis=null!=r&&""!=r&&"null"!=r?qv.util.capitalize(r):null;f.Position=u;f.Order=null!=p&&""!=p&&"null"!=p?qv.util.capitalize(p):null;d==QueryViewerOutputType.Table?(f.Filter=c(m[o],"","include",null,!0),f.Filter.Type=QueryViewerFilterType.ShowSomeValues):(f.Subtotals="no"==q?QueryViewerSubtotals.No:QueryViewerSubtotals.Yes,f.Filter=c(m[o],"filterType",
"include",QueryViewerFilterType.ShowSomeValues,!0),f.ExpandCollapse=c(m[o],"collapseType","includeExpand",QueryViewerExpandCollapseType.ExpandSomeValues,!1));g.push(f)}m=qv.util.dom.getMultipleElementsByTagName(e,"OLAPMeasure");for(o=0;o<m.length;o++)f={},n=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"name")),k="true"==qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"hidden")),u=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(m[o],"position")),
f.Name=n,f.Type=QueryViewerElementType.Datum,f.Hidden=k,f.Position=u,g.push(f);return g},GetDataPivot:function(a){return a.oat_element.getDataXML()},GetFilteredDataPivot:function(a){return a.oat_element.getFilteredDataXML()},onOAT_PIVOTDragAndDropEvent:function(a,d){if(a.RealType==QueryViewerOutputType.PivotTable&&(IsQueryObjectPreview()&&window.external.SendText(a.ControlName,d),a.DragAndDrop)){var c=qv.util.dom.xmlDocument(d),c=qv.util.dom.selectXPathNode(c,"/DATA");a.DragAndDropData.Name=c.getAttribute("name");
a.DragAndDropData.Type=QueryViewerElementType.Axis;axis=c.getAttribute("axis");a.DragAndDropData.Axis="rows"==axis?QueryViewerAxisType.Rows:"columns"==axis?QueryViewerAxisType.Columns:QueryViewerAxisType.Pages;a.DragAndDropData.Position=c.getAttribute("position");a.DragAndDrop()}},onItemClickEvent:function(a,d,c){var v,g;if(a.ItemClick&&!c||a.ItemDoubleClick&&c){g=c?g=a.ItemDoubleClickData:a.ItemClickData;var m=qv.util.dom.xmlDocument(d),o=qv.util.dom.selectXPathNode(m,"/DATA/ITEM"),d=qv.util.dom.selectXPathNode(m,
"/DATA/CONTEXT/RELATED"),m=qv.util.dom.selectXPathNode(m,"/DATA/CONTEXT/FILTERS");g.Name=o.getAttribute("name");v=o.getAttribute("location");switch(v){case "rows":g.Type=QueryViewerElementType.Axis;g.Axis=QueryViewerAxisType.Rows;break;case "columns":g.Type=QueryViewerElementType.Axis;g.Axis=QueryViewerAxisType.Columns;break;case "pages":g.Type=QueryViewerElementType.Axis;g.Axis=QueryViewerAxisType.Pages;break;default:g.Type=QueryViewerElementType.Datum,g.Axis=""}g.Value=null!=o.firstChild?o.firstChild.nodeValue:
"";g.Selected="true"==o.getAttribute("selected");o=[];for(v=0;v<a.Metadata.Axes.length;v++)a.Metadata.Axes[v].IsComponent&&o.push(a.Metadata.Axes[v].Name);for(v=0;v<a.Metadata.Data.length;v++)a.Metadata.Data[v].IsComponent&&o.push(a.Metadata.Data[v].Name);g.Context=e(d,o);g.Filters=e(m,o);c?a.ItemDoubleClick():a.ItemClick()}},onItemExpandCollapseEvent:function(a,d,c){var e;IsQueryObjectPreview()&&window.external.SendText(a.ControlName,d);if(a.ItemExpand&&!c||a.ItemCollapse&&c){e=c?e=a.ItemCollapseData:
a.ItemExpandData;var d=qv.util.dom.xmlDocument(d),g=qv.util.dom.selectXPathNode(d,"/DATA/ITEM"),d=qv.util.dom.selectXPathNode(d,"/DATA/CONTEXT/EXPANDEDVALUES");e.Name=g.getAttribute("name");e.Value=g.firstChild.nodeValue;e.ExpandedValues=[];for(var g=-1,m=0;m<d.childNodes.length;m++)"VALUE"==d.childNodes[m].nodeName&&(g++,e.ExpandedValues[g]=d.childNodes[m].firstChild.nodeValue);c?a.ItemCollapse():a.ItemExpand()}},Select:function(a,c){a.oat_element.selectValue(c)},Deselect:function(a){a.oat_element.deselectValue()}}}();
var HCChart,_highChartsDrawPointsWrapped,HIGHCHARTS_COLOR_PREFIX="highcharts-color-",HIGHCHARTS_MAX_COLORS=36,HIGHCHARTS_CUSTOM_COLOR=[],DEFAULTCHARTSPACING=10;
qv.chart=function(){function a(a){return a.RealChartType==QueryViewerChartType.Timeline||a.RealChartType==QueryViewerChartType.SmoothTimeline||a.RealChartType==QueryViewerChartType.StepTimeline}function c(h){return a(h)||h.RealChartType==QueryViewerChartType.Sparkline}function e(a){return a.RealChartType==QueryViewerChartType.Pie||a.RealChartType==QueryViewerChartType.Pie3D||a.RealChartType==QueryViewerChartType.Doughnut||a.RealChartType==QueryViewerChartType.Doughnut3D}function b(a){return a.RealChartType==
QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar||a.RealChartType==QueryViewerChartType.PolarArea}function d(a){return e(a)||a.RealChartType==QueryViewerChartType.Funnel||a.RealChartType==QueryViewerChartType.Pyramid}function s(a){return(a.RealChartType==QueryViewerChartType.ColumnLine||a.RealChartType==QueryViewerChartType.Column3DLine)&&1<a.Chart.Series.DataFields.length}function v(a){return a.RealChartType==QueryViewerChartType.CircularGauge||a.RealChartType==QueryViewerChartType.LinearGauge}
function g(a){return a.RealChartType==QueryViewerChartType.StackedColumn||a.RealChartType==QueryViewerChartType.StackedColumn3D||a.RealChartType==QueryViewerChartType.StackedColumn100||a.RealChartType==QueryViewerChartType.StackedBar||a.RealChartType==QueryViewerChartType.StackedBar100||a.RealChartType==QueryViewerChartType.StackedArea||a.RealChartType==QueryViewerChartType.StackedArea100||a.RealChartType==QueryViewerChartType.StackedLine||a.RealChartType==QueryViewerChartType.StackedLine100?!1:(a.PlotSeries==
QueryViewerPlotSeries.InSeparateCharts||d(a))&&1<a.Chart.Series.DataFields.length}function m(a,c){for(var d=[],b=0;b<a.Charts.length;b++)for(var f=0;f<a.Charts[b].series.length;f++)d.push(a.Charts[b].series[f].data[c]);return d}function o(a,c,d,b,f){for(var w=0;w<a.Charts.length;w++)if(c.id!=a.Charts[w].container.id)for(var e=0;e<a.Charts[w].series.length;e++){var g=a.Charts[w].series[e].data[d];b?(f&&g.setState("hover"),a.Charts[w].tooltip.hide(0)):g.setState()}}function f(a){switch(a){case QueryViewerChartType.Column:case QueryViewerChartType.Column3D:case QueryViewerChartType.StackedColumn:case QueryViewerChartType.StackedColumn3D:case QueryViewerChartType.StackedColumn100:case QueryViewerChartType.PolarArea:return"column";
case QueryViewerChartType.Bar:case QueryViewerChartType.StackedBar:case QueryViewerChartType.StackedBar100:case QueryViewerChartType.LinearGauge:return"bar";case QueryViewerChartType.Area:case QueryViewerChartType.StackedArea:case QueryViewerChartType.StackedArea100:case QueryViewerChartType.FilledRadar:case QueryViewerChartType.StepArea:return"area";case QueryViewerChartType.SmoothArea:return"areaspline";case QueryViewerChartType.Line:case QueryViewerChartType.StackedLine:case QueryViewerChartType.StackedLine100:case QueryViewerChartType.Radar:case QueryViewerChartType.Timeline:case QueryViewerChartType.StepTimeline:case QueryViewerChartType.Sparkline:case QueryViewerChartType.StepLine:return"line";
case QueryViewerChartType.SmoothLine:case QueryViewerChartType.SmoothTimeline:return"spline";case QueryViewerChartType.ColumnLine:case QueryViewerChartType.Column3DLine:return"column";case QueryViewerChartType.Pie:case QueryViewerChartType.Pie3D:case QueryViewerChartType.Doughnut:case QueryViewerChartType.Doughnut3D:return"pie";case QueryViewerChartType.Funnel:return"funnel";case QueryViewerChartType.Pyramid:return"pyramid";case QueryViewerChartType.CircularGauge:return"solidgauge";default:return"line"}}
function n(a,c,d,b,f,w,e){function g(a,d){var c={};c.Name=a.Name;var b=z(a.DataType,a.Picture),b=B(d,a.Picture,a.DataType,b);c.Values=[b];return c}a.Name=d;a.Type=b;a.Axis="";a.Value=f;a.Selected=w;a.Context=[];for(d=0;d<c.Metadata.Axes.length;d++)b=c.Metadata.Axes[d],b.IsComponent||(b=g(b,e[b.DataField]),a.Context.push(b));for(d=0;d<c.Metadata.Data.length;d++)b=c.Metadata.Data[d],b.IsComponent||(b=g(b,e[b.DataField]),a.Context.push(b));a.Filters=[]}function k(a,c){for(var d=!1,b=0;b<a.length;b++)for(var f=
a[b],w=0;w<f.series.length;w++){var e=f.series[w].points[c];if(e.selected){e.select();break}else e.select(!0,0<w),d=!0}return d}function r(a){for(var c=0;c<a.length;c++){var d=a[c].getSelectedPoints();0<d.length&&d[0].select(!1,!1)}}function u(a){var c=qv.collection[this.chart.options.qv.viewerId],d=!1;if(c.SelectionAllowed())if("Point"==c.SelectionType){if(a.point.select(),d=a.point.selected,c.PlotSeries==QueryViewerPlotSeries.InSeparateCharts&&d)for(var b=0;b<c.Charts.length;b++){var f=c.Charts[b].series[0].points[a.point.index];
f!=a.point&&f.select(!1)}}else d=k(c.Charts,a.point.index);c.ItemClick&&c.Metadata.Data[a.point.series.index].RaiseItemClick&&(b=c.Chart.Series.ByName[this.name],f=qv.util.formatNumber(a.point.y,b.NumberFormat.DecimalPrecision,b.Picture,!1),n(c.ItemClickData,c,b.FieldName,QueryViewerElementType.Datum,f,d,c.Data.Rows[a.point.index]),c.ItemClick())}function q(a,c){return""==c?qv.util.dom.createSpan(null,"","","",{fontWeight:"bold"},null,a).outerHTML:qv.util.dom.createSpan(null,"","","",{fontWeight:"bold",
color:c},null,a).outerHTML}function p(a,c){var d=Math.min(c.getContainerControl().offsetHeight,c.getContainerControl().offsetWidth)/(g(c)?c.Chart.Series.DataFields.length:1)/13;return qv.util.dom.createSpan(null,"","","",{color:K(c,a),fontSize:d+"px"},null,qv.util.formatNumber(a.point.y,2,"ZZZZZZZZZZZZZZ9.99",!0)+"%").outerHTML}function y(a,c){function d(a){for(var c=a.y,b=a.series.data,a=a.index,h="",h=a,f=a+1;f<b.length&&b[f].y==c;f++)h=f;h<b.length-1&&h++;for(var w=a,f=a-1;0<=f&&b[f].y==c;f--)w=
f;c=(b[h].x-b[w].x)/1E3;return h=" ("+gx.getMessage("GXPL_QViewerDuration")+": "+qv.util.seconsdToText(c)+")"}var b,f=qv.collection[a.points[0].series.chart.options.qv.viewerId];g(f)?b=m(f,a.points[0].point.index):(b=[],$.each(a.points,function(a,c){b.push(c.point)}));for(var w={},e=!1,O=0;O<b.length;O++){var H=b[O].series.name;void 0==w[H]&&(w[H]=[]);w[H].push(b[O]);1<w[H].length&&(e=!0)}var O="",J,G;for(G in w){var H=c[G],l=w[G],k=K(f,l[0]);e&&(O+=qv.util.dom.createSpan(null,"","","",{fontWeight:"bold",
color:k},null,G).outerHTML+"<br/>");for(var q=0;void 0!=l[q];q++){var I=l[q],r=parseInt(I.real_x?I.real_x:I.x);if(0<b.length&&b[0].series.chart.options.qv.comparing)O+=I.name+": "+qv.util.formatNumber(I.y,H.NumberFormat.DecimalPrecision,H.Picture,!1)+"<br/>";else{J!=r&&(O+=I.name+"<br/>",J=r);var r=f.RealChartType==QueryViewerChartType.StepTimeline?d(I):"",n=qv.util.dom.createSpan(null,"","","",{color:k},null,G+": ").outerHTML,I=qv.util.dom.createSpan(null,"","","",{fontWeight:"bold"},null,qv.util.formatNumber(I.y,
H.NumberFormat.DecimalPrecision,H.Picture,!1)).outerHTML,O=O+(n+I+r+"<br/>")}}}return O}function M(a){"undefined"===typeof _avoidSelectionEventHandler&&(_avoidSelectionEventHandler=!1);if(!_avoidSelectionEventHandler){L(da,"none");da=null;if(a.xAxis){var c=a.target.options.qv,b=a.xAxis[0];pa(a.target.options.qv.viewerId,100*((b.min-c.dataMin)/(c.dataMax-c.dataMin)),100*((b.max-c.dataMin)/(c.dataMax-c.dataMin)))}else pa(a.target.options.qv.viewerId,0,100);c=qv.collection[a.target.options.qv.viewerId];
if(g(c)){var c=c.getContainerControl().id,c=$("[id^="+c+"_chart]"),d=[];$.each(c,function(c,b){if(b.id!=a.target.renderTo.id){var f=$("#"+b.id).highcharts();d.push(f)}});$.each(d,function(c,d){a.xAxis?d.get("xaxis").setExtremes(b.min,b.max):(_avoidSelectionEventHandler=!0,d.zoomOut(),_avoidSelectionEventHandler=!1)})}}}function D(a,c,b,d,f){function w(a,c,b,d,h){function f(a,c){return a==QueryViewerDataType.Date?10==c.length:" "==c.charAt(10)}function e(a,c,b,d,h){var f=a.substr(0,4),w=a.substr(5,
2),a=a.substr(8,2);d||(c=c.replace("M",""));h||(c=c.replace("D",""));for(var g="",G=0;G<c.length;G++)g+=0==G?"":"/",g+=c.charAt(G);c=g.replace("Y",b?f:f.substr(2,2));d&&(c=c.replace("M",w));h&&(c=c.replace("D",a));return c}var w,g;if(""!=a)switch(h=h||(b==QueryViewerDataType.Date?"Days":"Seconds"),h){case "Years":w=a.substr(0,4)+"-01-01";g=e(w,d,f(b,c),!1,!1);break;case "Months":w=a.substr(0,7)+"-01";g=e(w,d,f(b,c),!0,!1);break;case "Semesters":w="06">=a.substr(5,2)?"01":"07";w=a.substr(0,5)+w+"-01";
h="06">=a.substr(5,2)?"01":"02";dateStrSemester=a.substr(0,5)+h+"-01";g=e(dateStrSemester,d,f(b,c),!0,!1);break;case "Quarters":w="03">=a.substr(5,2)?"01":"06">=a.substr(5,2)?"04":"09">=a.substr(5,2)?"07":"10";w=a.substr(0,5)+w+"-01";h="03">=a.substr(5,2)?"01":"06">=a.substr(5,2)?"02":"09">=a.substr(5,2)?"03":"04";dateStrQuarter=a.substr(0,5)+h+"-01";g=e(dateStrQuarter,d,f(b,c),!0,!1);break;case "Weeks":a=new gx.date.gxdate(a,"Y4MD");w=gx.date.dow(a);a=gx.date.dtadd(a,-86400*(w-1));w=qv.util.dateToString(a,
!1);g=e(w,d,f(b,c),!0,!0);break;case "Days":w=b==QueryViewerDataType.Date?a:a.substr(0,10);g=b==QueryViewerDataType.Date?c:c.substr(0,10);break;case "Hours":w=a.substr(0,13)+":00:00";g=c.substr(0,13)+":00";break;case "Minutes":w=a.substr(0,16)+":00";g=c.substr(0,16);break;case "Seconds":w=a,g=c}else g=w="";return{dateStr:w,name:g}}var e;e={dateStr:null,name:null};var g=[],H=[],J=[];for(i=0;i<c.length;i++){var G=a.Values[i].ValueWithPicture,l=a.Values[i].Value,k,q;null!=c[i].Value?d==QueryViewerAggregationType.Count?
(k=0,q=parseFloat(qv.util.trim(c[i].Value))):d==QueryViewerAggregationType.Average?(k=parseFloat(qv.util.trim(c[i].Value_N)),q=parseFloat(qv.util.trim(c[i].Value_D))):(k=parseFloat(qv.util.trim(c[i].Value)),q=1):(k=null,q=0);G=w(l,G,b,gx.dateFormat,f);G.dateStr==e.dateStr||0==i?(null!=k&&(g.push(k),H.push(q)),0==i&&(e=G)):(e={x:e.dateStr,y:qv.util.aggregate(d,g,H),name:e.name},J.push(e),e=G,g=[k],H=[q])}0<g.length&&0<H.length&&(e={x:e.dateStr,y:qv.util.aggregate(d,g,H),name:e.name},J.push(e));return J}
function R(a){var c=[],b=[],d="";for(i=0;i<a.Points.length;i++){var f,w;a.Aggregation==QueryViewerAggregationType.Count?(f=0,w=parseFloat(qv.util.trim(a.Points[i].Value))):a.Aggregation==QueryViewerAggregationType.Average?(f=parseFloat(qv.util.trim(a.Points[i].Value_N)),w=parseFloat(qv.util.trim(a.Points[i].Value_D))):(f=parseFloat(qv.util.trim(a.Points[i].Value)),w=1);c.push(f);b.push(w);""==d&&(d=a.Points[i].Color)}c=qv.util.aggregate(a.Aggregation,c,b).toString();a.Points=[{Value:c,Value_N:c,Value_D:"1",
Color:d}];a.NegativeValues=0>c;a.PositiveValues=0<c}function A(c){var b,d,f;a(c)?(c=DEFAULTCHARTSPACING,b=0,d=DEFAULTCHARTSPACING,f=0):f=d=b=c=DEFAULTCHARTSPACING;return[c,b,d,f]}function l(a,c){var b,d;b=3>=a?24:50/(a-1)-1;d=100-(b+1)*(c-1);return{Width:b,Center:d,LowerExtreme:d-b/2,UpperExtreme:d+b/2}}function E(a,c){var b=1/a/2,d=-0.5+(c-0.5)/a;return{Width:b,Center:d,LowerExtreme:d-b/2,UpperExtreme:d+b/2}}function B(a,c,b,d){switch(b){case QueryViewerDataType.Integer:case QueryViewerDataType.Real:return qv.util.formatNumber(a,
d.DecimalPrecision,c,!1);case QueryViewerDataType.Boolean:case QueryViewerDataType.Character:case QueryViewerDataType.GUID:return qv.util.trim(a);case QueryViewerDataType.Date:case QueryViewerDataType.DateTime:return qv.util.formatDateTime(a,b,d.DateFormat,d.IncludeHours,d.IncludeMinutes,d.IncludeSeconds,d.IncludeMilliseconds)}}function z(a,c){return a==QueryViewerDataType.Integer||a==QueryViewerDataType.Real?qv.util.ParseNumericPicture(a,c):a==QueryViewerDataType.Date||a==QueryViewerDataType.DateTime?
qv.util.ParseDateTimePicture(a,c):null}function x(b){function f(a){for(var c=0,b=0;b<a.length;b++)"F0"!=a[b].DataField&&c++;return c}function e(a){a.Chart.Categories={};a.Chart.Categories.DataFields=[];for(var c=0;c<a.Metadata.Axes.length;c++){var b=a.Metadata.Axes[c];(b.Visible==QueryViewerVisible.Yes||b.Visible==QueryViewerVisible.Always)&&a.Chart.Categories.DataFields.push(b.DataField)}a.Chart.Series={};a.Chart.Series.DataFields=[];b=f(a.Metadata.Data);for(c=0;c<a.Metadata.Data.length;c++){var d=
a.Metadata.Data[c];(1==b?d.Visible==QueryViewerVisible.Yes||d.Visible==QueryViewerVisible.Always:d.Visible!=QueryViewerVisible.Never)&&a.Chart.Series.DataFields.push(d.DataField)}}function l(a){for(var c={},b=0;b<a.Metadata.Axes.length;b++){var d=a.Metadata.Axes[b],f=z(d.DataType,d.Picture);c[d.DataField]={Picture:d.Picture,DataType:d.DataType,PictureProperties:f,Filter:d.Filter}}return c}function k(c,b){function e(c,b,f){function h(a){for(var c=!1,b=0;b<a.length;b++)if(w(a[b].StyleOrClass,!1)[0]){c=
!0;break}return c}d(c)||c.RealChartType==QueryViewerChartType.PolarArea&&1==c.Chart.Series.DataFields.length?f=!0:c.RealChartType==QueryViewerChartType.Area||c.RealChartType==QueryViewerChartType.StackedArea||c.RealChartType==QueryViewerChartType.StackedArea100||c.RealChartType==QueryViewerChartType.SmoothArea||c.RealChartType==QueryViewerChartType.StepArea||c.RealChartType==QueryViewerChartType.Line||c.RealChartType==QueryViewerChartType.StackedLine||c.RealChartType==QueryViewerChartType.StackedLine100||
c.RealChartType==QueryViewerChartType.SmoothLine||c.RealChartType==QueryViewerChartType.StepLine||c.RealChartType==QueryViewerChartType.Sparkline||a(c)||c.RealChartType==QueryViewerChartType.Radar||c.RealChartType==QueryViewerChartType.FilledRadar?f=!1:1<c.Chart.Series.DataFields.length&&!g(c)?f=!1:(c=h(b.ConditionalStyles),b=!1,null!=f&&(b=h(f.ValuesStyles)),f=c||b);return f}for(var h={},G=f(c.Metadata.Data),H=0;H<c.Metadata.Data.length;H++){var J=c.Metadata.Data[H];if(1==G?J.Visible==QueryViewerVisible.Yes||
J.Visible==QueryViewerVisible.Always:J.Visible!=QueryViewerVisible.Never){var C=e(c,J,b);h[J.DataField]={Datum:J,Multicolored:C}}}return h}function w(a,c){var b="",d=!1,f=c?"backgroundcolor":"color";if(""!=a){for(var w=a.split(";"),e=0;e<w.length;e++){var h=w[e].split(":");if(2==h.length){var g=h[1];if(h[0].toLowerCase()==f){b=g;d=""!=g;break}}}d&&"#"==b.substr(0,1)&&(b=b.replace("#",""))}return[d,b]}function va(a,c,b,d,f,e,h){function g(a,c){for(var b=[!1,""],d=0;d<a.ValuesStyles.length;d++){var f=
a.ValuesStyles[d];if(f.Value==c){b=w(f.StyleOrClass,!1);break}}return b}function G(a,c){for(var b=[!1,""],d=!1,f=0;f<a.ConditionalStyles.length;f++){var e=a.ConditionalStyles[f];if(d=qv.util.satisfyStyle(c,e)){b=w(e.StyleOrClass,!1);break}}return b}var H,J=-1,C=!1;if(a){if(a=!1,null!=b&&(b=g(b,e),a=b[0],H=b[1]),!a)b=G(c,h),a=b[0],H=b[1],a||(J=f%HIGHCHARTS_MAX_COLORS,C=!0)}else b=w(c.Style,!1),a=b[0],H=b[1],a||(J=d%HIGHCHARTS_MAX_COLORS,C=!0);return{IsDefault:C,Color:H,ColorIndex:J}}function O(a,c,
b,d){for(var f="",e="",w=0;w<a.Chart.Categories.DataFields.length;w++){var h=a.Chart.Categories.DataFields[w],g;void 0!=c[h]?(g=qv.util.trim(c[h]),h=B(g,d[h].Picture,d[h].DataType,d[h].PictureProperties)):h=g=a.Metadata.TextForNullValues;f+=(""==f?"":", ")+g;e+=(""==e?"":", ")+h}c=[f,e];d={};d.Value=c[0];d.ValueWithPicture=c[1];a.Chart.Categories.Values.push(d);if(0==b)a.Chart.Categories.MinValue=d.Value,a.Chart.Categories.MaxValue=d.Value;else if(d.Value>a.Chart.Categories.MaxValue&&(a.Chart.Categories.MaxValue=
d.Value),d.Value<a.Chart.Categories.MinValue)a.Chart.Categories.MinValue=d.Value}function H(a,c,b,d,f){for(var e=0;e<a.Chart.Series.DataFields.length;e++){var w=a.Chart.Series.ByIndex[e],h=a.Chart.Series.DataFields[e],g=void 0!=c[h]?c[h]:null,G={};G.Value=g;var H=d[h].Datum,J=d[h].Multicolored;if(H.Aggregation==QueryViewerAggregationType.Average){var C=c[h+"_N"],h=c[h+"_D"];void 0==C&&void 0==h&&(C=g,h="1");G.Value_N=C;G.Value_D=h}G.Color=J?va(J,H,f,0,b,a.Chart.Categories.Values[b].Value,g):qa("");
w.Points.push(G);0<G.Value&&(w.PositiveValues=!0);0>G.Value&&(w.NegativeValues=!0)}}function J(a,c){for(var b=0;b<c.ConditionalStyles.length;b++){var d=c.ConditionalStyles[b],f=w(d.StyleOrClass,!0),e=f[1];if(f[0]){plotBand={};plotBand.Color=qa(e);if(d.Operator==QueryViewerConditionOperator.Interval)plotBand.From=parseFloat(d.Value1),plotBand.To=parseFloat(d.Value2);else if(d.Operator==QueryViewerConditionOperator.Equal)plotBand.From=parseFloat(d.Value1),plotBand.To=parseFloat(d.Value1);else if(d.Operator==
QueryViewerConditionOperator.GreaterOrEqual||d.Operator==QueryViewerConditionOperator.GreaterThan)plotBand.From=parseFloat(d.Value1);else if(d.Operator==QueryViewerConditionOperator.LessOrEqual||d.Operator==QueryViewerConditionOperator.LessThan)plotBand.To=parseFloat(d.Value1);plotBand.SeriesName=""!=c.Title?c.Title:c.Name;a.Chart.PlotBands.push(plotBand)}}}function G(a,c){for(var b=!1,d=0;d<a.Metadata.Axes.length;d++){var f=a.Metadata.Axes[d];if(f.Visible==QueryViewerVisible.Yes||f.Visible==QueryViewerVisible.Always)if(f.Filter.Type==
QueryViewerFilterType.HideAllValues){b=!0;break}else if(f.Filter.Type==QueryViewerFilterType.ShowSomeValues){var e=qv.util.trim(c[f.DataField]);if(0>f.Filter.Values.indexOf(e)){b=!0;break}}}return b}if(function(a){return c(a)?(a=Q(a),a==QueryViewerDataType.Date||a==QueryViewerDataType.DateTime):!0}(b)){b.Chart={};e(b);b.Chart.Categories.MinValue=null;b.Chart.Categories.MaxValue=null;b.Chart.Categories.Values=[];var q=l(b);b.Chart.Series.ByName={};b.Chart.Series.ByIndex=[];var r=1==b.Chart.Categories.DataFields.length?
ea(b,b.Chart.Categories.DataFields[0]):null,n=k(b,r);b.Chart.PlotBands=[];for(var I=0;I<b.Chart.Series.DataFields.length;I++){var m=b.Chart.Series.DataFields[I],o=n[m].Datum,p={},m=n[m].Multicolored;p.FieldName=o.Name;p.Name=""!=o.Title?o.Title:o.Name;p.Visible=o.Visible;p.DataType=o.DataType;p.Aggregation=o.Aggregation;var u=o.Picture;p.Picture=""==u?p.DataType==QueryViewerDataType.Integer?"ZZZZZZZZZZZZZZ9":"ZZZZZZZZZZZZZZ9.99":u;p.NumberFormat=qv.util.ParseNumericPicture(p.DataType,p.Picture);p.Color=
m?qa(""):va(m,o,r,I,0,"",0);p.TargetValue=o.TargetValue;p.MaximumValue=o.MaximumValue;t(p);p.PositiveValues=!1;p.NegativeValues=!1;p.Points=[];b.Chart.Series.ByName[p.Name]=p;b.Chart.Series.ByIndex.push(p);J(b,o)}for(I=o=0;I<b.Data.Rows.length;I++)p=b.Data.Rows[I],G(b,p)||(O(b,p,o,q),H(b,p,o,n,r),o++);if(v(b))for(I=0;I<b.Chart.Series.DataFields.length;I++)p=b.Chart.Series.ByIndex[I],R(p);return""}return gx.getMessage("GXPL_QViewerNoDatetimeAxis")}function t(a){0>=a.TargetValue&&(a.TargetValue=100);
0>=a.MaximumValue&&(a.MaximumValue=100);a.MaximumValue<a.TargetValue&&(a.MaximumValue=a.TargetValue)}function N(a){a._themeStyleSheet||(a._themeStyleSheet=S(gx.theme+".css"));return a._themeStyleSheet}function S(a){for(var c,b=0;b<document.styleSheets.length;b++)if(null!=document.styleSheets[b].href&&0<=document.styleSheets[b].href.indexOf(a)){c=document.styleSheets[b];break}return c}function F(a,c,b){for(var d=0,f=0;f<c.cssRules.length;f++){var e=c.cssRules[f];if(e.selectorText&&0==e.selectorText.indexOf(b)){var g=
e.selectorText.replace(b,"");a[g]=e.style.fill;d++}if(d==HIGHCHARTS_MAX_COLORS)break}}function K(a,c){var b;b=c.className&&0==c.className.indexOf("highcharts-color-")?parseInt(c.className.replace("highcharts-color-","")):c.colorIndex;if(b<HIGHCHARTS_MAX_COLORS){if(!a._HighchartsDefaultColors){a._HighchartsDefaultColors=[];var d={},f,e;a._queryViewerStyleSheet||(a._queryViewerStyleSheet=S("QueryViewer.css"));f=a._queryViewerStyleSheet;F(d,f,".highcharts-color-");""!=a.Class&&(f=N(a),e="."+qv.util.GetContainerControlClass(a)+
" .highcharts-color-",F(d,f,e));for(f=0;f<HIGHCHARTS_MAX_COLORS;f++)a._HighchartsDefaultColors.push(d[f.toString()])}b=a._HighchartsDefaultColors[b]}else b=HIGHCHARTS_CUSTOM_COLOR[b-HIGHCHARTS_MAX_COLORS],6===b.length&&!isNaN(parseInt(b,16))&&(b="#"+b);return b}function qa(a){return{IsDefault:!1,Color:a,ColorIndex:"-1"}}function Z(a){return a.IsDefault?0>a.ColorIndex:""==a.Color}function W(a,c,b,d){if(!Z(b)){if(b.IsDefault)a=b.ColorIndex;else{var f=b.Color,b=HIGHCHARTS_CUSTOM_COLOR.indexOf(f);if(0>
b){HIGHCHARTS_CUSTOM_COLOR.push(f);var b=HIGHCHARTS_CUSTOM_COLOR.length-1,b=HIGHCHARTS_MAX_COLORS+b,e=6===f.length&&!isNaN(parseInt(f,16))?"#":"",f="."+HIGHCHARTS_COLOR_PREFIX+b+" {fill: "+e+f+"; stroke: "+e+f+";}",a=N(a);a.insertRule(f,a.cssRules.length)}else b=HIGHCHARTS_MAX_COLORS+b;a=b}d?c.colorIndex=a:c.className=HIGHCHARTS_COLOR_PREFIX+a}}function wa(h,k,C){var r=Q(h)==QueryViewerDataType.Date?"Days":"Seconds",n={qv:{}};n.qv.viewerId=h.userControlId();n.chart=function(c,b){var d={styledMode:!0};
d.spacing=A(c);if(g(c)){var e=c.userControlId(),e=a(c)?ga(e):e;d.renderTo=document.getElementById(e+"_chart"+b.toString())}else d.renderTo=a(c)?document.getElementById(ga(c.userControlId())):c.getContainerControl();s(c)||(d.type=f(c.RealChartType));c.RealChartType==QueryViewerChartType.Radar||c.RealChartType==QueryViewerChartType.FilledRadar||c.RealChartType==QueryViewerChartType.PolarArea?d.polar=!0:c.RealChartType==QueryViewerChartType.Column3D||c.RealChartType==QueryViewerChartType.StackedColumn3D||
c.RealChartType==QueryViewerChartType.Column3DLine?d.options3d={enabled:!0,alpha:15,beta:15,depth:50,viewDistance:25}:c.RealChartType==QueryViewerChartType.Pie3D||c.RealChartType==QueryViewerChartType.Doughnut3D?d.options3d={enabled:!0,alpha:45,beta:0}:a(c)&&(d.zoomType="x",d.resetZoomButton={theme:{display:"none"}},d.events={},d.events.selection=function(a){M(a)});return d}(h,C);n.credits={enabled:!1};n.legend={enabled:1<h.Chart.Series.DataFields.length&&!g(h)||d(h),margin:0};n.title=""==h.Title?
{text:null}:{text:null==C||0==C?h.Title:null};n.subtitle=function(a,c){var b={};if(g(a)&&(d(a)||a.RealChartType==QueryViewerChartType.CircularGauge))b.text=c.Name,b.floating=!0,b.align="left",b.verticalAlign="middle";return b}(h,k);n.pane=function(a,c){var b={};if(a.RealChartType==QueryViewerChartType.CircularGauge){b.background=[];var d;g(a)&&(d=l(1,1));var f=0,e;for(e in a.Chart.Series.ByName){if(!g(a)||f==c){var h=a.Chart.Series.ByName[e],k={};g(a)||(d=l(a.Chart.Series.DataFields.length,f+1));
k.outerRadius=d.UpperExtreme.toString()+"%";k.innerRadius=d.LowerExtreme.toString()+"%";h=Z(h.Color)?h.Points[0].Color:h.Color;W(a,k,h,!1);k.borderWidth=0;b.background.push(k)}f++}}return b}(h,C);n.xAxis=function(a,d){xAxis={};if(a.RealChartType!=QueryViewerChartType.CircularGauge){var f=c(a);if(a.RealChartType!=QueryViewerChartType.Radar&&a.RealChartType!=QueryViewerChartType.FilledRadar&&a.RealChartType!=QueryViewerChartType.PolarArea&&a.RealChartType!=QueryViewerChartType.LinearGauge&&a.RealChartType!=
QueryViewerChartType.Sparkline){var e=xAxis,h="";if(""==a.XAxisTitle)for(var G=0;G<a.Metadata.Axes.length;G++){var k=a.Metadata.Axes[G];if(k.Visible==QueryViewerVisible.Yes||k.Visible==QueryViewerVisible.Always)h+=(""==h?"":", ")+gx.getMessage(k.Title)}else h=gx.getMessage(a.XAxisTitle);e.title={text:h}}else{a.RealChartType==QueryViewerChartType.Sparkline&&g(a)&&(xAxis.title={text:a.Chart.Series.ByIndex[d].Name});xAxis.lineWidth=0;if(a.RealChartType==QueryViewerChartType.LinearGauge||a.RealChartType==
QueryViewerChartType.Sparkline)xAxis.tickPositions=[];xAxis.tickmarkPlacement=a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar?"on":"between"}if(a.RealChartType==QueryViewerChartType.LinearGauge){var e=0,l;g(a)&&(l=E(1,1));xAxis.plotBands=[];for(var C in a.Chart.Series.ByName){if(!g(a)||e==d)h=a.Chart.Series.ByName[C],g(a)||(l=E(a.Chart.Series.DataFields.length,e+1)),plotBand={},h=Z(h.Color)?h.Points[0].Color:h.Color,W(a,plotBand,h,!1),plotBand.from=l.LowerExtreme,
plotBand.to=l.UpperExtreme,xAxis.plotBands.push(plotBand);e++}}f||(xAxis.categories=[]);l=!1;for(e=0;e<a.Chart.Categories.Values.length;e++)""!=a.Chart.Categories.Values[e].ValueWithPicture&&(l=!0),f||(xAxis.categories[e]=a.Chart.Categories.Values[e].ValueWithPicture);if(f)xAxis.type="datetime",xAxis.id="xaxis",xAxis.minRange=1,Q(a)==QueryViewerDataType.Date&&(null!=a.Chart.Categories.MaxValue&&null!=a.Chart.Categories.MinValue)&&(f=new gx.date.gxdate(a.Chart.Categories.MinValue,"Y4MD"),864E6>(new gx.date.gxdate(a.Chart.Categories.MaxValue,
"Y4MD")).Value.getTime()-f.Value.getTime()&&(xAxis.tickInterval=864E5));else if(xAxis.labels={},xAxis.labels.enabled=l,a.XAxisLabels!=QueryViewerXAxisLabels.Horizontally&&!(a.RealChartType==QueryViewerChartType.Bar||a.RealChartType==QueryViewerChartType.StackedBar||a.RealChartType==QueryViewerChartType.StackedBar100)&&!b(a))a.XAxisLabels==QueryViewerXAxisLabels.Vertically?(f=90,l=5):(f=parseInt(a.XAxisLabels.replace("Rotated","")),l=10),xAxis.labels.rotation=360-f,xAxis.labels.y=l,xAxis.labels.align=
"right";b(a)?xAxis.className="highcharts-no-axis-line highcharts-yes-grid-line":a.RealChartType==QueryViewerChartType.Sparkline&&(xAxis.className="highcharts-no-axis-line highcharts-no-grid-line")}return xAxis}(h,C);n.yAxis=function(a,c){function b(a){if(0==a.length)return!1;for(var c,d=0;d<a.length;d++)if(0==d)c=a[d].Picture;else if(a[d].Picture!=c)return!1;return!0}if(a.RealChartType==QueryViewerChartType.Sparkline)yAxis={visible:!1};else{var d;d=a.RealChartType==QueryViewerChartType.CircularGauge?
null:g(a)?c.Name:ha(a);s(a)&&!g(a)?(yAxis=[],yAxis[0]={title:{text:d}},yAxis[1]={title:{text:""},opposite:!0}):yAxis={title:{text:d}};yAxis.plotLines=[];yAxis.plotBands=[];if(!e(a)&&!(a.RealChartType==QueryViewerChartType.Funnel||a.RealChartType==QueryViewerChartType.Pyramid)&&!v(a)){for(var f=0;f<a.Chart.PlotBands.length;f++){var h=a.Chart.PlotBands[f];if(null==c||c.Name==h.SeriesName)h.From==h.To&&null!=h.From?(d={value:h.From,width:1,zIndex:3},W(a,d,h.Color,!1),yAxis.plotLines.push(d)):(d={},W(a,
d,h.Color,!1),d.from=!h.From?Number.MIN_VALUE:h.From,d.to=!h.To?Number.MAX_VALUE:h.To,yAxis.plotBands.push(d))}if(g(a)||1==a.Chart.Series.ByIndex.length||b(a.Chart.Series.ByIndex)){var l=g(a)?c:a.Chart.Series.ByIndex[0];yAxis.labels={};yAxis.labels.formatter=function(){return qv.util.formatNumber(this.value,l.NumberFormat.DecimalPrecision,l.Picture,true)}}}if(a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar||a.RealChartType==QueryViewerChartType.PolarArea)yAxis.min=
0,yAxis.gridLineInterpolation=a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar?"polygon":"circle";if(v(a)){yAxis.min=0;yAxis.max=0;for(var k in a.Chart.Series.ByName)if(!g(a)||k==c.Name)d=a.Chart.Series.ByName[k],yAxis.max=Math.max(yAxis.max,100*d.MaximumValue/d.TargetValue);if(a.RealChartType==QueryViewerChartType.LinearGauge||100!=yAxis.max){d={className:"highcharts-dashed-plot-line",value:100};if(g(a)||1==a.Chart.Series.DataFields.length){var f=g(a)?
c:a.Chart.Series.ByIndex[0],C,n;a.RealChartType==QueryViewerChartType.LinearGauge?(h=-10,C=-5,n="right"):(h=15,C=0,n="center");d.label={text:f.TargetValue,verticalAlign:"bottom",rotation:0,y:h,x:C,align:n}}yAxis.plotLines.push(d)}}a.RealChartType==QueryViewerChartType.LinearGauge?(yAxis.className="highcharts-no-axis-line highcharts-no-grid-line",yAxis.labels={enabled:!1}):a.RealChartType==QueryViewerChartType.CircularGauge&&(yAxis.lineWidth=0,yAxis.tickPositions=[]);if(gx.lang.gxBoolean(a.XAxisIntersectionAtZero)){h=
f=!1;for(k in a.Chart.Series.ByName)d=a.Chart.Series.ByName[k],d.PositiveValues&&(f=!0),d.NegativeValues&&(h=!0);h||(s(a)&&!g(a)?(yAxis[0].min=0,yAxis[1].min=0):yAxis.min=0);f||(s(a)&&!g(a)?(yAxis[0].max=0,yAxis[1].max=0):yAxis.max=0)}}return yAxis}(h,k);n.plotOptions=function(c,b){function d(a){var b;b=g(a)||1==a.Chart.Series.DataFields.length?23*(g(a)?a.Chart.Series.DataFields.length:1):29;return a.getContainerControl().offsetHeight-b}function f(a){var b={radius:1,symbol:"circle",states:{hover:{radius:4}}};
a.SelectionAllowed()&&(b.states.select={radius:5,lineWidth:1});return b}var e=gx.lang.gxBoolean(b.ShowValues),h={series:{}};h.series.events={};b.RealChartType==QueryViewerChartType.CircularGauge?(h.series.dataLabels={},h.series.dataLabels.enabled=1==b.Chart.Series.DataFields.length&&gx.lang.gxBoolean(b.ShowValues)||g(b),h.series.dataLabels.y=0,h.series.dataLabels.borderWidth=0,h.series.dataLabels.formatter=function(){return p(this,b)},h.series.marker={enabled:!1}):e&&(h.series.dataLabels={},h.series.dataLabels.enabled=
!0,h.series.dataLabels.connectorColor="#000000",h.series.dataLabels.formatter=function(){var a=b.Chart.Series.ByName[this.series.name];return qv.util.formatNumber(this.point.y*(b.RealChartType==QueryViewerChartType.LinearGauge?a.TargetValue/100:1),a.NumberFormat.DecimalPrecision,a.Picture,!1)},b.RealChartType==QueryViewerChartType.LinearGauge&&(h.series.dataLabels.inside=!0));if(g(b)&&b.RealChartType!=QueryViewerChartType.CircularGauge){h.series.point={};h.series.point.events={};var l=b.RealChartType!=
QueryViewerChartType.LinearGauge;h.series.point.events.mouseOver=function(){o(b,this.series.chart.container,this.index,true,l)};h.series.point.events.mouseOut=function(){o(b,this.series.chart.container,this.index,false,l)}}if(b.ItemClick||b.SelectionAllowed())h.series.events.click=u;switch(c){case "bar":h.bar={};b.RealChartType==QueryViewerChartType.StackedBar?(h.series.stacking="normal",h.bar.stacking="normal"):b.RealChartType==QueryViewerChartType.StackedBar100&&(h.series.stacking="percent",h.bar.stacking=
"percent");if(b.RealChartType==QueryViewerChartType.LinearGauge){e=E(b.Chart.Series.DataFields.length,1).Width*d(b);h.bar.pointWidth=e;h.bar.pointPadding=0;h.bar.groupPadding=0;for(var k=Number.MAX_VALUE,C=0;C<b.Chart.Series.DataFields.length;C++){var n=b.Chart.Series.ByIndex[C],n=n.Points[0].Value/n.TargetValue;n<k&&(k=n)}k*=b.getContainerControl().offsetWidth;h.bar.borderRadius=Math.min(e/2,k/2)}break;case "column":h.column={};b.RealChartType==QueryViewerChartType.StackedColumn||b.RealChartType==
QueryViewerChartType.StackedColumn3D||b.RealChartType==QueryViewerChartType.PolarArea?(h.series.stacking="normal",h.column.stacking="normal"):b.RealChartType==QueryViewerChartType.StackedColumn100&&(h.series.stacking="percent",h.column.stacking="percent");b.RealChartType==QueryViewerChartType.PolarArea&&(h.column.pointPadding=0,h.column.groupPadding=0);break;case "area":h.area={};b.RealChartType==QueryViewerChartType.StepArea&&(h.area.step="center");h.area.marker=f(b);b.RealChartType==QueryViewerChartType.StackedArea?
h.area.stacking="normal":b.RealChartType==QueryViewerChartType.StackedArea100&&(h.area.stacking="percent");break;case "areaspline":h.areaspline={};h.areaspline.marker=f(b);break;case "line":h.line={};h.line.marker=f(b);b.RealChartType==QueryViewerChartType.StepLine?h.line.step="center":b.RealChartType==QueryViewerChartType.StepTimeline&&(h.line.step="left");a(b)?h.series.connectNulls=!0:b.RealChartType==QueryViewerChartType.StackedLine?h.line.stacking="normal":b.RealChartType==QueryViewerChartType.StackedLine100&&
(h.line.stacking="percent");break;case "spline":h.spline={};h.spline.marker=f(b);break;case "pie":h.pie={};if(b.RealChartType==QueryViewerChartType.Doughnut||b.RealChartType==QueryViewerChartType.Doughnut3D)h.pie.innerSize="35%";if(b.RealChartType==QueryViewerChartType.Pie3D||b.RealChartType==QueryViewerChartType.Doughnut3D)h.pie.depth=35;h.pie.dataLabels={enabled:e};h.pie.showInLegend=!0;break;case "solidgauge":h.solidgauge={};h.solidgauge.showInLegend=!0;h.solidgauge.rounded=!0;break;case "funnel":h.funnel=
{};h.funnel.showInLegend=!0;h.funnel.dataLabels={enabled:e};break;case "pyramid":h.pyramid={},h.pyramid.showInLegend=!0,h.pyramid.dataLabels={enabled:e}}return h}(n.chart.type,h);n.tooltip=function(b){var c={};a(b)?(c.borderRadius=1,c.shadow=!0,c.shared=!0,c.useHTML=!1,c.formatter=function(){return y(this,b.Chart.Series.ByName)}):b.RealChartType==QueryViewerChartType.StackedColumn100||b.RealChartType==QueryViewerChartType.StackedBar100||b.RealChartType==QueryViewerChartType.StackedArea100||b.RealChartType==
QueryViewerChartType.StackedLine100?c.formatter=function(){return"<b>"+(""!=this.point.id?this.point.id:this.series.name)+"</b>: "+Math.round(100*this.point.percentage)/100+"%"}:e(b)?c.formatter=function(){var a;if(g(b)){a=qv.collection[this.point.series.chart.options.qv.viewerId];var c=d(a),f=m(a,this.point.index),h=0<f.length?f[0].id:"",e=""!=h,k="";e&&(k+=q(h,c?K(a,this):""));for(h=0;h<f.length;h++)var l=f[h],k=k+((e||0<h?"<br/>":"")+q(l.series.name+": ",c?"":K(a,l.series))),l=Math.round(100*l.percentage)/
100,k=k+(l+"%");a=k}else l=Math.round(100*this.point.percentage)/100,a="<b>"+(""!=this.point.name?this.point.name:this.point.series.name)+"</b>: "+l+"%";return a}:b.RealChartType==QueryViewerChartType.CircularGauge?(c.enabled=(1<b.Chart.Series.DataFields.length||!gx.lang.gxBoolean(b.ShowValues))&&!g(b),c.formatter=function(){return p(this,b)},c.positioner=function(a){return{x:(this.chart.plotWidth-a)/2,y:this.chart.plotHeight/2}}):c.formatter=function(){var a;var c=b.Chart.Series.ByName;if(!g(b)||
v(b)){a=qv.collection[this.series.chart.options.qv.viewerId];var f=c[this.series.name],c=v(a)?"ZZZZZZZZZZZZZZ9.99":f.Picture,h=v(a)?2:f.NumberFormat.DecimalPrecision,f=v(a);a="<b>"+(""!=this.point.id?this.point.id:this.series.name)+"</b>: "+qv.util.formatNumber(this.point.y,h,c,f)+(v(a)?"%":"")}else{this.points?(a=this.points[0],f=a.point.index):(a=this.point,f=a.index);a=qv.collection[a.series.chart.options.qv.viewerId];var h=d(a),e=m(a,f),f=!this.key?!this.x?"":this.x:this.key,k=""!=f&&a.RealChartType!=
QueryViewerChartType.Sparkline,l="";k&&(l+=q(f,h?K(a,this):""));for(var C=0;C<e.length;C++)var n=e[C],f=c[n.series.name],l=l+((k||0<C?"<br/>":"")+q(n.series.name+": ",h?"":K(a,n))),l=l+qv.util.formatNumber(n.y,f.NumberFormat.DecimalPrecision,f.Picture,!1);a=l}return a};return c}(h);n.series=function(b,d,f){function h(b,d,f,e,k){e={};b.ItemClick&&b.Metadata.Data[f].RaiseItemClick&&(e.className="highcharts-drilldown-point");e.visible=d.Visible==QueryViewerVisible.Yes||d.Visible==QueryViewerVisible.Always;
e.events={legendItemClick:function(a){if(d.Visible==QueryViewerVisible.Always)a.preventDefault();else{var c=qv.chart.GetRuntimeMetadata(b),a=qv.util.GetElementInCollection(c,"Name",b.Chart.Series.ByIndex[a.target.index].FieldName);a.Hidden=!a.Hidden;qv.util.autorefresh.UpdateLayoutSameGroup(b,c,false)}}};if(a(b)){e.name=d.Name;e.data=[];e.turboThreshold=0;Z(d.Color)||W(b,e,d.Color,!0);var n=D(b.Chart.Categories,d.Points,Q(b),d.Aggregation,k);for(j=0;j<n.length;j++){var f=n[j].name,C=n[j].x,k=n[j].y,
C=new gx.date.gxdate(C,"Y4MD");e.data[j]={x:C.Value.getTime()-6E4*C.Value.getTimezoneOffset(),y:k,name:f};Z(d.Color)&&W(b,e.data[j],d.Points[j].Color,!0)}}else{b.RealChartType==QueryViewerChartType.CircularGauge&&(n=g(b)?l(1,1):l(b.Chart.Series.DataFields.length,f+1));e.name=d.Name;e.data=[];e.turboThreshold=0;Z(d.Color)||W(b,e,d.Color,!0);if(b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==QueryViewerChartType.FilledRadar||b.RealChartType==QueryViewerChartType.PolarArea)e.pointPlacement=
b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==QueryViewerChartType.FilledRadar?"on":null;for(j=0;j<d.Points.length;j++)(k=null!=d.Points[j].Value?parseFloat(qv.util.trim(d.Points[j].Value).replace(",",".")):null,v(b)&&(k=100*(k/d.TargetValue)),f=b.Chart.Categories.Values[j].ValueWithPicture,e.data[j]={},e.data[j].y=k,e.data[j].name=v(b)?"":f,e.data[j].id=e.data[j].name,c(b)&&(C=b.Chart.Categories.Values[j].Value,C=new gx.date.gxdate(C,"Y4MD"),e.data[j].x=C.Value.getTime()-6E4*C.Value.getTimezoneOffset(),
e.data[j].id=C),b.RealChartType==QueryViewerChartType.CircularGauge&&(e.data[j].radius=n.UpperExtreme.toString()+"%",e.data[j].innerRadius=n.LowerExtreme.toString()+"%"),b.RealChartType==QueryViewerChartType.CircularGauge)?(f=Z(d.Color)?d.Points[0].Color:d.Color,W(b,e.data[j],f,!0)):Z(d.Color)&&W(b,e.data[j],d.Points[j].Color,!0)}return e}var e=[],k=0,C;for(C in b.Chart.Series.ByName){if(!g(b)||k==d){var n=h(b,b.Chart.Series.ByName[C],k,e,f),q=null!=d?d:k;s(b)&&(0==q%2?(n.type="column",n.yAxis=0):
(n.type="line",n.yAxis=g(b)?0:1));e.push(n)}k++}return e}(h,C,r);return n}function ea(a,b){for(var c=0;c<a.Metadata.Axes.length;c++)if(a.Metadata.Axes[c].DataField==b)return a.Metadata.Axes[c]}function Q(a){for(var b=0,c="",d=0;d<a.Metadata.Axes.length;d++){var f=a.Metadata.Axes[d];if(f.Visible==QueryViewerVisible.Yes||f.Visible==QueryViewerVisible.Always)b++,c=f.DataType}return 1==b?c:QueryViewerDataType.Character}function ha(a){var b="";if(""==a.YAxisTitle){if(1==a.Chart.Series.DataFields.length){var c;
a:for(b=0;b<a.Metadata.Data.length;b++)if(a.Metadata.Data[b].DataField==a.Chart.Series.DataFields[0]){c=a.Metadata.Data[b];break a}b=gx.getMessage(c.Title)}}else b=gx.getMessage(a.YAxisTitle);return b}function P(a){return!isNaN(parseFloat(a))&&isFinite(a)?gx.dom.el(aa+"_Zoom_"+a+"m"):gx.dom.el(a)}function L(a,b){if(zoom=P(a))zoom.style.textDecoration=b}function xa(a){if(zoom=P(a))zoom.onclick();else if(0!=a){var b;switch(a){case 12:b=6;break;case 6:b=3;break;case 3:b=2;break;case 2:b=1;break;case 1:b=
0}xa(b)}}function ya(a,b){gx.dom.el(a+"_options_compare_enable").disabled=!b;gx.dom.el(a+"_options_compare_text").disabled=!b;gx.dom.el(a+"_options_compare_text").style.opacity=!b?0.5:1;gx.dom.el(a+"_options_compare_options").disabled=!b;gx.dom.el(a+"_options_compare_options").style.opacity=!b?0.5:1}function ca(a){return a+"_options"}function ga(a){return a+"_center"}function ba(a){return a+"_footer_slider"}function ra(a){return a+"_footer_chart"}function fa(a){return a+"_footer_range"}function la(a){return a+
"_footer_left_cursor"}function ma(a){return a+"_footer_right_cursor"}function ia(a){return a+"_footer_center"}function pa(a,b,c){var d=Math.max(b,0),b=Math.min(d,100),d=Math.max(c,0),c=Math.min(d,100);$("#"+(a+"_footer")).css("width","100%").css("height",X.toString()+"px");$("#"+ra(a)).css("width","100%").css("height",(X-2).toString()+"px");d=qv.collection[a].getContainerControl().offsetWidth;b=b*d/100;c=(100-c)*d/100;if(d-b-c<2*Y){var f=2*Y-(d-b-c),e;e=0==f%2?f/2:(f+1)/2;b-=e;c-=f-e;0>b&&(c+=b,b=
0);0>c&&(b+=c,c=0)}$("#"+ba(a)).css("width","100%").css("height",X.toString()+"px").css("padding-left",(100*b/d).toString()+"%").css("padding-right",(100*c/d).toString()+"%");$("#"+fa(a)).css("width","100%").css("height",X.toString()+"px");$("#"+la(a)).css("width",Y.toString()+"px").css("height",X.toString()+"px");$("#"+ma(a)).css("width",Y.toString()+"px").css("height",X.toString()+"px");$("#"+ia(a)).css("width","calc(100% - "+2*Y+"px)").css("height",X.toString()+"px").css("left",Y.toString()+"px")}
function za(a,b){var c=parseInt($("#"+ba(a)).css("padding-left")),d=parseInt($("#"+fa(a)).css("width")),f;f=b.originalEvent.touches?b.originalEvent.touches[0].pageX-b.originalEvent.touches[0].target.offsetLeft:b.offsetX;switch(b.target.id){case ba(a):return f;case la(a):return f+c;case ia(a):return f+c;case ma(a):return f+c+d-Y}}function Ba(b){function c(a){a.preventDefault();T=b;var d=$("#"+ba(T)),f=$("#"+fa(T));parseInt(d.css("padding-left"));Aa=za(T,a);na=parseInt(d.css("padding-left"));sa=parseInt(d.css("padding-right"));
oa=parseInt(d.css("width"));ta=parseInt(f.css("width"))}function d(){if(ja||U||V){var b=$("#"+ba(T)),c=qv.collection[T],f=gx.dom.el(T+"_options_compare_enable").checked,e=c.getContainerControl().offsetWidth,h;h=a(c)?ga(c.userControlId()):c.getContainerControl().id;var c=g(c)?$("[id^="+h+"_chart]"):$("#"+h),k=[];$.each(c,function(a,b){var c=$("#"+b.id).highcharts();k.push(c)});c=k[0];h=parseInt(b.css("padding-left"));var l=parseInt(b.css("padding-right")),b=100*h/e,e=100*(1-l/e);if(0==b&&100==e)$.each(k,
function(a,b){b.zoomOut()});else{c.get("xaxis").getExtremes();var c=c.options.qv,n=c.dataMin+b/100*(c.dataMax-c.dataMin),w=c.dataMin+e/100*(c.dataMax-c.dataMin),q=f?!1:!0;$.each(k,function(a,b){b.get("xaxis").setExtremes(n,w,q)})}f&&ka(k);if(U||V)L(da,"none"),da=null}U=V=ja=!1}function f(a){if(ja||U||V)if(a=za(T,a)-Aa,a=V?Math.min(a,ta-2*Y):Math.min(a,sa),a=U?Math.max(a,-ta+2*Y):Math.max(a,-na),0!=a){$("#"+ia(T));var b=$("#"+ba(T));$("#"+fa(T));V?b.css("padding-left",(100*(na+a)/oa).toString()+"%"):
(U||b.css("padding-left",(100*(na+a)/oa).toString()+"%"),b.css("padding-right",(100*(sa-a)/oa).toString()+"%"))}}var e=$("#"+la(b)),k=$("#"+ma(b)),l=$("#"+ia(b)),n=$("#"+ba(b));$("#"+fa(b));e.mousedown(function(a){a.preventDefault();V=!0});k.mousedown(function(a){a.preventDefault();U=!0});l.mousedown(function(a){a.preventDefault();!V&&!U&&(ja=!0)});n.mousedown(function(a){c(a)});$(document).mouseup(function(a){d(a)});n.mousemove(function(a){f(a)});e.on("touchstart",function(a){a.preventDefault();
V=!0});k.on("touchstart",function(a){a.preventDefault();U=!0});l.on("touchstart",function(a){a.preventDefault();!V&&!U&&(ja=!0)});n.on("touchstart",function(a){c(a)});$(document).on("touchend",function(a){d(a)});$(document).on("touchcancel",function(a){d(a)});n.on("touchmove",function(a){f(a)})}function Ca(a,b){var c=qv.util.dom.createDiv(a,ba(b),"gx-qv-footer-slider","",{},""),c=qv.util.dom.createDiv(c,fa(b),"gx-qv-footer-range","",{},"");qv.util.dom.createDiv(c,la(b),"gx-qv-footer-left-cursor",
"",{},"");qv.util.dom.createDiv(c,ma(b),"gx-qv-footer-right-cursor","",{},"");qv.util.dom.createDiv(c,ia(b),"gx-qv-footer-center","",{},"");qv.util.dom.createDiv(a,ra(b),"gx-qv-footer-chart","",{},"")}function Da(a,b){var c=ra(a.userControlId()),d=a.RealChartType==QueryViewerChartType.SmoothTimeline?"spline":"line",f=a.RealChartType==QueryViewerChartType.StepTimeline?"left":"",e=[];if(g(a))for(k=0;k<b.length;k++)e.push(b[k].series[0]);else for(var k=0;k<b[0].series.length;k++)e.push(b[0].series[k]);
return qv.chart.getSparklineChartOptions(a,c,d,!1,f,e)}function ka(a){var b=a[0],c=b.options.qv.viewerId,d=qv.collection[c],f=gx.dom.el(c+"_options_compare_enable").checked;$.each(a,function(a,b){b.options.qv.comparing=f});var e=b.get("xaxis").getExtremes();void 0!=e.userMin&&(e.min=e.userMin);void 0!=e.userMax&&(e.max=e.userMax);if(f){var k=gx.dom.el(c+"_options_compare_options").children,l;for(ind=0;void 0!=k[ind]&&void 0==l;ind++)k[ind].selected&&(l=k[ind].value);var n,q;"PrevPeriod"==l?(q=new Date(e.min),
n=new Date(e.min-(e.max-e.min))):"PrevYear"==l&&(n=new Date(e.min),n=new Date(n.setFullYear(n.getFullYear()-1)),q=new Date(e.max),q=new Date(q.setFullYear(q.getFullYear()-1)));n=n.getTime();q=q.getTime();if(zoom=P(c+"_Zoom_0m"))zoom.style.display="none"}else if(zoom=P(c+"_Zoom_0m"))zoom.style.display="";$.each(a,function(a,b){for(var c=[];b.series.length>0;){b.options.qv.colorIndexesUsed||c.push(b.series[0].colorIndex);b.series[0].remove(true)}if(!b.options.qv.colorIndexesUsed)b.options.qv.colorIndexesUsed=
c});var k=0,o;for(o in d.Chart.Series.ByName){var r=d.Chart.Series.ByName[o],p,m;g(d)?(p=a[k],m=p.options.qv.colorIndexesUsed[0]):(p=b,m=p.options.qv.colorIndexesUsed[k]);var t={turboThreshold:0};t.colorIndex=m;t.id=o+"1";t.name=o;t.data=[];if(f){var u={className:"highcharts-dashed-series-line",turboThreshold:0};u.colorIndex=m;u.id=o+"2";u.name=o;u.data=[]}m=document.getElementById(c+"_options_group_options").value;r=D(d.Chart.Categories,r.Points,Q(d),r.Aggregation,m);for(i=0;i<r.length;i++){m=r[i].y;
var s=new gx.date.gxdate(r[i].x,"Y4MD"),y=r[i].name,v=s.Value.getTime()-6E4*s.Value.getTimezoneOffset(),s=s.Value.getTime()-6E4*s.Value.getTimezoneOffset();if(f){var x=!1,z=!1;v<=e.max&&v>=e.min&&(x=!0);if(v<=q&&v>=n){var z=!0,A=new Date(v),B;"PrevPeriod"==l?B="1m"==p.options.qv.predef_zoom?A.setMonth(A.getMonth()+1):"2m"==p.options.qv.predef_zoom?A.setMonth(A.getMonth()+2):"3m"==p.options.qv.predef_zoom?A.setMonth(A.getMonth()+3):"6m"==p.options.qv.predef_zoom?A.setMonth(A.getMonth()+6):"12m"==p.options.qv.predef_zoom?
A.setFullYear(A.getFullYear()+1):B+(e.max-e.min):"PrevYear"==l&&(B=A.setFullYear(A.getFullYear()+1))}x&&(x={},x.x=v,x.y=m,x.name=y,t.data.push(x));z&&(x={},x.x=B,x.y=m,x.name=y,x.real_x=s,u.data.push(x))}else t.data.push({x:v,y:m,name:y})}p.addSeries(t);f&&p.addSeries(u);k++}}function Ea(a,b){if(a.length<b)return 0;var c=(a[a.length-1].x-a[a.length-b].x)/1E3/3600/24/(365/12);return 1>=c?1:2>=c?2:3>=c?3:6>=c?6:12}function Fa(a,b){function c(a,b,d,f,e,h,g,k,l){var n=b.userControlId(),a=qv.util.dom.createSelect(a,
ca(n)+"_group_options");Q(b)==QueryViewerDataType.DateTime&&(qv.util.dom.createOption(a,"Seconds","Seconds"==b._groupOption,gx.getMessage("GXPL_QViewerSeconds")),l&&(qv.util.dom.createOption(a,"Minutes","Minutes"==b._groupOption,gx.getMessage("GXPL_QViewerMinutes")),k&&qv.util.dom.createOption(a,"Hours","Hours"==b._groupOption,gx.getMessage("GXPL_QViewerHours"))));if(y||Q(b)==QueryViewerDataType.Date)qv.util.dom.createOption(a,"Days","Days"==b._groupOption,gx.getMessage("GXPL_QViewerDays")),g&&(qv.util.dom.createOption(a,
"Weeks","Weeks"==b._groupOption,gx.getMessage("GXPL_QViewerWeeks")),h&&(qv.util.dom.createOption(a,"Months","Months"==b._groupOption,gx.getMessage("GXPL_QViewerMonths")),e&&(qv.util.dom.createOption(a,"Quarters","Quarters"==b._groupOption,gx.getMessage("GXPL_QViewerQuarters")),f&&(qv.util.dom.createOption(a,"Semesters","Semesters"==b._groupOption,gx.getMessage("GXPL_QViewerSemesters")),d&&qv.util.dom.createOption(a,"Years","Years"==b._groupOption,gx.getMessage("GXPL_QViewerYears"))))));return a}var d=
a[0];aa=d.options.qv.viewerId;var f=qv.collection[aa],e=document.getElementById(ca(aa)),g=document.getElementById(aa+"_footer"),k=d.get("xaxis").getExtremes(),l=k.dataMax-k.dataMin;$.each(a,function(a,b){b.options.qv.dataMax=k.dataMax;b.options.qv.dataMin=k.dataMin});var n=2628288E3<l,q=5255712E3<l,o=7884E6<l,r=15768E6<l,l=31536E6<l;f._groupOption=f._groupOption||(Q(f)==QueryViewerDataType.Date?"Days":"Seconds");var p=new gx.date.gxdate(""),m=new gx.date.gxdate("");p.Value.setTime(k.dataMin+6E4*p.Value.getTimezoneOffset());
m.Value.setTime(k.dataMax+6E4*m.Value.getTimezoneOffset());var t=!0,u=!0,x=!0,s=!0,v=!0,y=!0,A=!0,z=!0;gx.date.year(p)==gx.date.year(m)&&(t=!1,6>=gx.date.month(p)&&7<=gx.date.month(m)||(u=!1,3>=gx.date.month(p)&&4<=gx.date.month(m)||(6>=gx.date.month(p)&&7<=gx.date.month(m)||9>=gx.date.month(p)&&10<=gx.date.month(m))||(x=!1,gx.date.month(p)==gx.date.month(m)&&(s=!1,gx.date.day(p)-gx.date.dow(p)==gx.date.day(m)-gx.date.dow(m)&&(v=!1,gx.date.day(p)==gx.date.day(m)&&(y=!1,gx.date.hour(p)==gx.date.hour(m)&&
(A=!1,gx.date.minute(p)==gx.date.minute(m)&&(z=!1))))))));(function(a,b,d,f,e,h,g,k,l,n,q,p,m,o){function r(a){return qv.util.dom.createDiv(a,"","QVTimelineHeaderGroup","",{height:ua+"px",flexGrow:1},"")}function w(a,b,c){return qv.util.dom.createAnchor(a,c,{cursor:"pointer",paddingLeft:"6px"},b)}var t=b.userControlId(),a=qv.util.dom.createDiv(a,"","QVTimelineHeader","",{display:"flex",flexDirection:"row",flexWrap:"wrap"},""),u=r(a),x=r(a),s=r(a),u=qv.util.dom.createDiv(u,"","","",{"float":"left"},
"");qv.util.dom.createText(u,gx.getMessage("GXPL_QViewerJSChartZoom"));if(d){w(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToOneMonth"),t+"_Zoom_1m");if(f){w(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToTwoMonth"),t+"_Zoom_2m");if(e){w(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToThreeMonth"),t+"_Zoom_3m");if(h){w(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToSixMonth"),t+"_Zoom_6m");g&&w(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToOneYear"),t+"_Zoom_12m")}}}}w(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToAll"),
t+"_Zoom_0m");d=qv.util.dom.createDiv(x,"","","",{"float":"right",paddingLeft:"12px"},"");qv.util.dom.createSpan(d,ca(t)+"_groupby_text","","",{whiteSpace:"nowrap",paddingRight:"6px"},null,gx.getMessage("GXPL_QViewerGroupBy"));c(d,b,k,l,n,q,p,m,o);b=qv.util.dom.createDiv(s,"","","",{"float":"right",paddingLeft:"12px"},"");qv.util.dom.createInput(b,ca(t)+"_compare_enable","checkbox",{verticalAlign:"sub"});qv.util.dom.createSpan(b,ca(t)+"_compare_text","","",{whiteSpace:"nowrap",paddingRight:"6px",
paddingLeft:"6px"},null,gx.getMessage("GXPL_QViewerCompareWith"));t=qv.util.dom.createSelect(b,ca(t)+"_compare_options");qv.util.dom.createOption(t,"PrevPeriod",false,gx.getMessage("GXPL_QViewerPreviousPeriod"));qv.util.dom.createOption(t,"PrevYear",false,gx.getMessage("GXPL_QViewerPreviousYear"));return a})(e,f,n,q,o,r,l,t,u,x,s,v,A,z);Ca(g,aa);Ba(aa);gx.dom.el(e.id+"_compare_enable").onclick=function(){ka(a)};gx.dom.el(e.id+"_compare_options").onchange=function(){gx.dom.el(e.id+"_compare_enable").checked&&
ka(a)};gx.dom.el(e.id+"_group_options").onchange=function(){ka(a)};var g=function(b){var c=gx.dom.el(e.id+"_compare_enable").checked;if(b>0){var f,g;g=d.get("xaxis").getExtremes().dataMax;f=g-b*2628028800;var k=c?false:true;$.each(a,function(a,b){b.get("xaxis").setExtremes(f,g,k)});var l=d.options.qv;pa(d.options.qv.viewerId,(f-l.dataMin)/(l.dataMax-l.dataMin)*100,(g-l.dataMin)/(l.dataMax-l.dataMin)*100);ya(d.options.qv.viewerId,true)}else{$.each(a,function(a,b){b.zoomOut()});ya(d.options.qv.viewerId,
false)}L(da,"none");L(this.id,"underline");$.each(a,function(a,c){c.options.qv.predef_zoom=b+"m"});da=this.id;c&&ka(a)},n=[0,1,2,3,6,12],D;for(D in n)if(q=n[D],o=gx.dom.el(aa+"_Zoom_"+q+"m"))o.onclick=g.closure(o,[q]);D=Ea(d.series[0].points,20);xa(D);f=Da(f,b);new Highcharts.Chart(f)}function Ga(b){var d=qv.collection[b.options.qv.viewerId];if(!c(d)){var f=d.SelectionAllowed(),e=!1;if(d.ItemClick)for(var g=0;g<d.Metadata.Axes.length;g++)if(d.Metadata.Axes[g].RaiseItemClick){e=!0;break}(e||f)&&jQuery.each(b.xAxis[0].ticks,
function(c,d){d&&d.label&&(e&&d.label.addClass("gx-qv-clickable-element"),d.label.on("click",function(){var g=e,l=qv.collection[b.options.qv.viewerId],q=!1;f&&!a(l)&&(q=k(l.Charts,d.pos));g&&(g=1==l.Chart.Categories.DataFields.length?ea(l,l.Chart.Categories.DataFields[0]).Name:"",n(l.ItemClickData,l,g,QueryViewerElementType.Axis,d.label.textStr,q,l.Data.Rows[c]),l.ItemClick())}))})}}var da=null,aa=null,ua=35,X=50,Y=10,Aa=0,T="",na=0,sa=0,ta=0,oa=0,V=!1,U=!1,ja=!1;return{tryToRenderChart:function(b){var c=
"";(new Date).getTime();b.xml=b.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(b,function(b,d){var f=!1;b!=d.xml.recordsetCacheKey&&(d.xml.recordsetCacheKey=b,f=!0);qv.util.anyError(b)?(c=qv.util.getErrorFromText(b),qv.util.renderError(d,c)):(f&&qv.services.parseRecordsetCacheKeyXML(d),qv.services.GetMetadataIfNeeded(d,function(b,d){var f=false;if(b!=d.xml.metadata){d.xml.metadata=b;f=true}(new Date).getTime();if(qv.util.anyError(b)){c=qv.util.getErrorFromText(b);qv.util.renderError(d,c)}else{f&&
qv.services.parseMetadataXML(d);qv.services.GetDataIfNeeded(d,function(b,d){var f=false;if(b!=d.xml.data){d.xml.data=b;f=true}(new Date).getTime();if(qv.util.anyError(b)){c=qv.util.getErrorFromText(b);qv.util.renderError(d,c)}else{f&&qv.services.parseDataXML(d);f=qv.util.GetContainerControlClasses(d);f!=""&&qv.util.SetUserControlClass(d,f);f=x(d);if(f==""){var e=d.userControlId(),f=qv.util.dom.getEmptyContainer(d);if((a(d)||g(d))&&f.offsetHeight==0)f.style.height="400px";if(a(d)){qv.util.dom.createDiv(f,
ca(e),"QVTimelineHeaderContainer","",{width:"100%",height:ua+"px"},"");var h=qv.util.dom.createDiv(f,ga(e),"","",{width:"100%",height:"calc(100% - "+ua+"px - "+X+"px)"},"");qv.util.dom.createDiv(f,e+"_footer","gx-qv-footer","",{width:"100%",height:X+"px"},"");f.style.padding=DEFAULTCHARTSPACING+"px";f=h}if(g(d))for(var h=d.Chart.Series.DataFields.length,k=parseInt(100/h),l=100%h,e=a(d)?ga(e):e,n=0;n<h;n++)qv.util.dom.createDiv(f,e+"_chart"+n.toString(),"","",{width:"100%",height:(k+(n<l?1:0)).toString()+
"%"},"");f=[];if(g(d)){var h=0,q;for(q in d.Chart.Series.ByName){k=wa(d,d.Chart.Series.ByName[q],h);f.push(k);h++}}else{k=wa(d,null,null);f.push(k)}if(d.RealChartType==QueryViewerChartType.CircularGauge){q=N(d);q.insertRule("#"+d.ContainerName+" .highcharts-tooltip-box {fill: none !important; stroke-width: 0 !important; }",q.cssRules.length)}Highcharts.setOptions({lang:{months:[gx.getMessage("GXPL_QViewerJanuary"),gx.getMessage("GXPL_QViewerFebruary"),gx.getMessage("GXPL_QViewerMarch"),gx.getMessage("GXPL_QViewerApril"),
gx.getMessage("GXPL_QViewerMay"),gx.getMessage("GXPL_QViewerJune"),gx.getMessage("GXPL_QViewerJuly"),gx.getMessage("GXPL_QViewerAugust"),gx.getMessage("GXPL_QViewerSeptember"),gx.getMessage("GXPL_QViewerOctober"),gx.getMessage("GXPL_QViewerNovember"),gx.getMessage("GXPL_QViewerDecember")],weekdays:[gx.getMessage("GXPL_QViewerSunday"),gx.getMessage("GXPL_QViewerMonday"),gx.getMessage("GXPL_QViewerTuesday"),gx.getMessage("GXPL_QViewerWednesday"),gx.getMessage("GXPL_QViewerThursday"),gx.getMessage("GXPL_QViewerFriday"),
gx.getMessage("GXPL_QViewerSaturday")],shortMonths:[gx.getMessage("GXPL_QViewerJanuary").substring(0,3),gx.getMessage("GXPL_QViewerFebruary").substring(0,3),gx.getMessage("GXPL_QViewerMarch").substring(0,3),gx.getMessage("GXPL_QViewerApril").substring(0,3),gx.getMessage("GXPL_QViewerMay").substring(0,3),gx.getMessage("GXPL_QViewerJune").substring(0,3),gx.getMessage("GXPL_QViewerJuly").substring(0,3),gx.getMessage("GXPL_QViewerAugust").substring(0,3),gx.getMessage("GXPL_QViewerSeptember").substring(0,
3),gx.getMessage("GXPL_QViewerOctober").substring(0,3),gx.getMessage("GXPL_QViewerNovember").substring(0,3),gx.getMessage("GXPL_QViewerDecember").substring(0,3)],numericSymbols:null}});q=[];for(h=0;h<f.length;h++){HCChart=new Highcharts.Chart(f[h],Ga);q.push(HCChart)}d.Charts=q;a(d)&&Fa(q,f);d._ControlRenderedTo=d.RealType;qv.util.hideActivityIndicator(d)}else qv.util.renderError(d,f)}})}}))})},GetMetadataChart:function(a){var b=qv.util.GetDesigntimeMetadata(a);(function(a,b){function c(a,b,d){for(var f=
0;f<a.length;f++){var e=a[f];if(e.Name==b){e.Visible=d?QueryViewerVisible.Yes:QueryViewerVisible.No;break}}}if(a.PlotSeries==QueryViewerPlotSeries.InTheSameChart)for(var d=0;d<a.Charts[0].series.length;d++){var f=a.Charts[0].series[d],e=a.Chart.Series.ByIndex[d].FieldName;c(b,e,f.visible)}else for(d=0;d<a.Charts.length;d++)f=a.Charts[d].series[0],e=a.Chart.Series.ByIndex[d].FieldName,c(b,e,f.visible)})(a,b);return b},GetRuntimeMetadata:function(a){for(var b=[],c,d=c=0;d<a.Metadata.Axes.length;d++){var f=
a.Metadata.Axes[d];f.Visible!=QueryViewerVisible.Never&&(c+=1);b.push({Name:f.Name,Type:QueryViewerElementType.Axis,Axis:f.Axis,Position:f.Visible!=QueryViewerVisible.Never?c:null,Hidden:f.Visible==QueryViewerVisible.Never||f.Visible==QueryViewerVisible.No})}for(d=c=0;d<a.Metadata.Data.length;d++)f=a.Metadata.Data[d],f.Visible!=QueryViewerVisible.Never&&(c+=1),b.push({Name:f.Name,Type:QueryViewerElementType.Datum,Axis:"",Position:f.Visible!=QueryViewerVisible.Never?c:null,Hidden:f.Visible==QueryViewerVisible.Never||
f.Visible==QueryViewerVisible.No});if(a.PlotSeries==QueryViewerPlotSeries.InTheSameChart)for(c=0;c<a.Charts[0].series.length;c++)d=a.Charts[0].series[c],f=a.Chart.Series.ByIndex[c].FieldName,f=qv.util.GetElementInCollection(b,"Name",f),f.Hidden=!d.visible;else for(c=0;c<a.Charts.length;c++)d=a.Charts[c].series[0],f=a.Chart.Series.ByIndex[c].FieldName,f=qv.util.GetElementInCollection(b,"Name",f),f.Hidden=!d.visible;return b},GetDataChart:function(a){return a.xml.data},getSparklineChartOptions:function(a,
b,c,d,f,e){a={chart:{}};a.chart.renderTo=b;a.chart.margin=0;a.chart.type=c;d&&(a.chart.className="highcharts-no-background");a.title={};a.title.text="";a.credits={};a.credits.enabled=!1;a.xAxis={};a.xAxis.visible=!1;a.yAxis={};a.yAxis.visible=!1;a.legend={};a.legend.enabled=!1;a.tooltip={};a.tooltip.enabled=!1;a.plotOptions={};a.plotOptions.series={};a.plotOptions.series.animation=!1;a.plotOptions.series.connectNulls=!0;a.plotOptions.series.enableMouseTracking=!1;a.plotOptions.series.lineWidth=1;
a.plotOptions.series.shadow=!1;a.plotOptions.series.states={};a.plotOptions.series.states.hover={};a.plotOptions.series.states.hover.lineWidth=1;a.plotOptions.series.marker={};a.plotOptions.series.marker.radius=0;a.plotOptions.series.marker.states={};a.plotOptions.series.marker.states.hover={};a.plotOptions.series.marker.states.hover.radius=2;""!=f&&(a.plotOptions.series.step=f);a.series=[];for(b=0;b<e.length;b++)a.series.push(e[b]);return a},IsDatetimeXAxis:function(a){return c(a)},Select:function(a,
b){for(var c=[],d=0;d<a.Data.Rows.length;d++){var f=a.Data.Rows[d],e=!0;for(j=0;j<b.length;j++){var g=b[j];if(f[g.DataField]&&qv.util.trim(f[g.DataField])!=qv.util.trim(g.Value)){e=!1;break}}e&&c.push(d)}if(0<c.length){d=a.Charts;for(f=0;f<d.length;f++)for(var e=d[f],g=!1,k=0;k<c.length;k++)for(var l=c[k],n=0;n<e.series.length;n++)e.series[n].points[l].select(!0,g),g||(g=!0)}else r(a.Charts)},Deselect:function(a){r(a.Charts)}}}();
qv.card=function(){function a(a,b){for(var c={},d=0;d<a.length;d++){var e=a[d],g;g=e;for(var p=b,m=[],o=[],s=[],v=0;v<p.length;v++){var A=p[v];if(g.IsFormula){var l=0;do{l++;var E=A[g.DataField+"_"+l.toString()];void 0!=E&&(E=parseFloat(E),0==v?s.push(E):s[l-1]+=E)}while(void 0!=E)}else g.Aggregation==QueryViewerAggregationType.Count?(l=0,A=parseFloat(A[g.DataField])):g.Aggregation==QueryViewerAggregationType.Average?(l=parseFloat(A[g.DataField+"_N"]),A=parseFloat(A[g.DataField+"_D"])):(l=parseFloat(A[g.DataField]),
A=1),m.push(l),o.push(A)}g=g.IsFormula?qv.util.evaluate(g.Formula,g.DataField+"_",s):qv.util.aggregate(g.Aggregation,m,o).toString();c[e.DataField]=g}return c}function c(a,b){if(0!=a.ConditionalStyles.length)for(var c=0;c<a.ConditionalStyles.length;c++){var d=a.ConditionalStyles[c];if(qv.util.satisfyStyle(b,d))return qv.util.css.parseStyle(d.StyleOrClass)}return qv.util.css.parseStyle(a.Style)}function e(a,b,c,d){function e(a,b){var c=gx.date.now(),d;switch(a){case QueryViewerTrendPeriod.LastYear:d=
gx.date.addyr(c,-1);break;case QueryViewerTrendPeriod.LastSemester:d=gx.date.addmth(c,-6);break;case QueryViewerTrendPeriod.LastQuarter:d=gx.date.addmth(c,-3);break;case QueryViewerTrendPeriod.LastMonth:d=gx.date.addmth(c,-1);break;case QueryViewerTrendPeriod.LastWeek:d=gx.date.dtadd(c,-604800);break;case QueryViewerTrendPeriod.LastDay:d=gx.date.dtadd(c,-86400);break;case QueryViewerTrendPeriod.LastHour:d=gx.date.dtadd(c,-3600);break;case QueryViewerTrendPeriod.LastMinute:d=gx.date.dtadd(c,-60);break;
case QueryViewerTrendPeriod.LastSecond:d=gx.date.dtadd(c,-1)}return qv.util.dateToString(d,b==QueryViewerDataType.DateTime)}var g={};if(a.IncludeTrend)if(a.TrendPeriod==QueryViewerTrendPeriod.SinceTheBeginning||""==a.TrendPeriod)g=0;else for(var m=e(a.TrendPeriod,d),g=a.Data.Rows.length-1,o=a.Data.Rows.length-2;0<=o&&!(a.Data.Rows[o][c]<m);o--)g=o;else g=a.Data.Rows.length-1;return g=function(a,b,c,d,f,e){var g=null,k=null,n=null,m=null,o=[],p={AnyTrend:!1};if(""!=c){for(var q=f.length-1,r=0,u=0,
s=0,v=0,y=0,ea=0,Q=null,ha=null;a<=q;a++)if(void 0!=f[a][c]&&void 0!=f[a][d]){var r=r+1,P=new gx.date.gxdate(f[a][c],"Y4MD"),L=parseFloat(f[a][d]);o.push({x:P.Value.getTime()-6E4*P.Value.getTimezoneOffset(),y:L});if(null==g&&null==k)k=g=L,n=f[a][c],m=f[a][c];else if(L>k&&(m=f[a][c],k=L),L<g)n=f[a][c],g=L;a>=b&&(null==Q&&null==ha&&(Q=P,ha=L),P=e==QueryViewerDataType.Date?gx.date.daysDiff(P,Q):gx.date.secDiff(P,Q),L-=ha,u+=P,s+=L,v+=P*L,y+=P*P,ea+=L*L)}p.AnyTrend=1<r;p.Slope=(r*v-u*s)/(r*y-u*u);p.Intercept=
(s-p.Slope*u)/r;p.R2=Math.pow((r*v-u*s)/Math.sqrt((r*y-u*u)*(r*ea-s*s)),2)}b={};b.LinearRegression=p;b.MinValue=g;b.MinWhen=n;b.MaxValue=k;b.MaxWhen=m;b.ChartSeriesData=o;return b}(a.IncludeSparkline||a.IncludeMaxAndMin?0:g,g,c,b.DataField,a.Data.Rows,d)}function b(b,c,d,e){function g(a,b){function c(a,b,d){var f=[];if(d)for(d=0;d<b.length;d++)f.push(b[d][a]);else f.push(b[b.length-1][a]);return f}for(var d=[],f=0;f<a.Metadata.Axes.length;f++){var e=a.Metadata.Axes[f];if(!e.IsComponent){var k={};
k.Name=e.Name;k.Values=c(e.DataField,a.Data.Rows,b);d.push(k)}}for(f=0;f<a.Metadata.Data.length;f++)e=a.Metadata.Data[f],e.IsComponent||(k={},k.Name=e.Name,k.Values=c(e.DataField,a.Data.Rows,b),d.push(k));return d}for(var m=null,p=0;p<c.Metadata.Data.length;p++)if(c.Metadata.Data[p].Name==d){m=c.Metadata.Data[p];break}null!=m&&(b.Name=m.Name,b.Type=QueryViewerElementType.Datum,b.Axis="",d=e?a(c.Metadata.Data,c.Data.Rows):c.Data.Rows[c.Data.Rows.length-1],b.Value=d[m.DataField],b.Context=g(c,e))}function d(a,
b){return a+"_card_sparkline_"+b}function s(a,b,c){c=d(a.userControlId(),c);return qv.chart.getSparklineChartOptions(a,c,"line",!0,"",[{data:b}])}function v(a,b,c,d){var e={textAlign:"center",paddingTop:"0px",paddingRight:"5px",paddingBottom:"0px",paddingLeft:"5px"},a=qv.util.dom.createTable(a,"",{}),g;g=qv.util.dom.createRow(a);g=qv.util.dom.createCell(g,1,"",e,"");qv.util.dom.createSpan(g,"","qv-card-max-and-min-value",c,{},null,b);g=qv.util.dom.createRow(a);g=qv.util.dom.createCell(g,1,"",e,"");
qv.util.dom.createSpan(g,"","qv-card-max-and-min-title",c,{},null,d);return a}function g(a){var a=new gx.date.gxdate(a,"Y4MD"),b=gx.date.now(),a=gx.date.secDiff(b,a);return gx.getMessage("GXPL_QViewerTimeAgo").replace("{0}",qv.util.seconsdToText(a))}function m(a,b,c,d){""!=b?(d=qv.util.formatNumber(parseFloat(b),d,c.Picture,!1),b=qv.util.formatNumber(parseFloat(100*b/c.TargetValue),2,"ZZZZZZZZZZZZZZ9.99",!1)+"%"):b=d="";switch(a.ShowDataAs){case QueryViewerShowDataAs.Values:return d;case QueryViewerShowDataAs.Percentages:return b;
case QueryViewerShowDataAs.ValuesAndPercentages:return d+" ("+b+")";default:return d}}function o(b){function n(a,b,c){var c=0<c.LinearRegression.Slope?"keyboard_arrow_up":0>c.LinearRegression.Slope?"keyboard_arrow_down":"drag_handle",d;d=""==b.TrendPeriod?gx.getMessage("GXPL_QViewerSinceTheBeginningTrend"):gx.getMessage("GXPL_QViewer"+b.TrendPeriod+"Trend");var f={width:"0px",marginLeft:"5px"};b.IncludeSparkline||(f.position="relative",f.top="2px");f.fontSize="36px";return c=qv.util.dom.createIcon(a,
d,f,c)}for(var k=0<b.Data.Rows.length,o=!0,u="",q,p=0;p<b.Metadata.Axes.length;p++){var y=b.Metadata.Axes[p];if(y.DataType==QueryViewerDataType.Date||y.DataType==QueryViewerDataType.DateTime){o=!1;u=y.DataField;q=y.DataType;break}}var M;k&&(M=o?a(b.Metadata.Data,b.Data.Rows):b.Data.Rows[b.Data.Rows.length-1]);var D=qv.util.dom.getEmptyContainer(b);y=b.IsAutoResize()?p="":p="100%";var p=qv.util.dom.createTable(D,qv.util.GetContainerControlClasses(b),{width:p,height:y}),p=qv.util.dom.createRow(p),D=
qv.util.dom.createCell(p,1,"center",{},""),p=b.Orientation==QueryViewerOrientation.Horizontal?"100%":"",y=b.Orientation==QueryViewerOrientation.Vertical?"100%":"",D=qv.util.dom.createTable(D,"",{width:p,height:y,whiteSpace:"nowrap"}),R;b.Orientation==QueryViewerOrientation.Horizontal&&(R=qv.util.dom.createRow(D));y=[];for(p=0;p<b.Metadata.Data.length;p++){var A=b.Metadata.Data[p];if(A.Visible==QueryViewerVisible.Yes||A.Visible==QueryViewerVisible.Always){var l=qv.util.ParseNumericPicture(A.DataType,
A.Picture).DecimalPrecision,E,B,z;k?(E=M[A.DataField],B=m(b,M[A.DataField],A,l),z=g(M[u])):z=B=E="";if((gx.lang.gxBoolean(b.IncludeTrend)||gx.lang.gxBoolean(b.IncludeSparkline)||gx.lang.gxBoolean(b.IncludeMaxAndMin))&&k){var x=e(b,A,u,q);y.push(x)}var t=c(A,E);E={};var N="qv-card-element-value";qv.util.startsWith(t,"{")&&qv.util.endsWith(t,"}")?E=JSON.parse(t):N=t;t=null;b.ItemClick&&A.RaiseItemClick&&(N+=(""==N?"":" ")+"gx-qv-clickable-element",t=function(){qv.card.fireItemClickEvent(event,b,o)});
b.Orientation==QueryViewerOrientation.Vertical&&(R=qv.util.dom.createRow(D));var S=b.Orientation==QueryViewerOrientation.Horizontal?"10px":"",F=b.Orientation==QueryViewerOrientation.Vertical?"10px":"",S=qv.util.dom.createCell(R,1,"center",{paddingRight:S,paddingLeft:S,paddingBottom:F,paddingTop:F},""),S=qv.util.dom.createTable(S,"",{}),F=qv.util.dom.createRow(S),F=qv.util.dom.createCell(F,1,"center",{},""),F=qv.util.dom.createTable(F,"",{}),F=qv.util.dom.createRow(F),K=qv.util.dom.createCell(F,1,
"center",{},"");qv.util.dom.createSpan(K,b.getContainerControl().id+"_"+A.Name,N,""!=u?z:"",E,t,B);var K=qv.util.dom.createCell(F,1,"",{},"");k&&(b.IncludeTrend&&!b.IncludeSparkline&&x.LinearRegression.AnyTrend)&&n(K,b,x);F=qv.util.dom.createRow(S);F=qv.util.dom.createCell(F,1,"center",{},"");span1=qv.util.dom.createSpan(F,"","qv-card-element-title",""!=u?z:"",{},null,A.Title);b.IncludeSparkline&&(""!=u&&k)&&(F=qv.util.dom.createRow(S),F=qv.util.dom.createCell(F,1,"",{},""),F=qv.util.dom.createTable(F,
"",{width:"100%"}),F=qv.util.dom.createRow(F),K=qv.util.dom.createCell(F,1,"",{width:"100%"},""),qv.util.dom.createDiv(K,d(b.userControlId(),p),"","",{height:"50px",width:"100%",minWidth:"100px"},""),K=qv.util.dom.createCell(F,1,"",{width:"0%"},""),k&&(b.IncludeTrend&&x.LinearRegression.AnyTrend)&&n(K,b,x));b.IncludeMaxAndMin&&(""!=u&&k)&&(F=qv.util.dom.createRow(S),F=qv.util.dom.createCell(F,1,"center",{},""),F=qv.util.dom.createTable(F,"",{"margin-top":"10px"}),F=qv.util.dom.createRow(F),K=qv.util.dom.createCell(F,
1,"",{},""),v(K,m(b,x.MinValue,A,l),g(x.MinWhen),gx.getMessage("GXPL_QViewerCardMinimum")),K=qv.util.dom.createCell(F,1,"",{},""),v(K,m(b,x.MaxValue,A,l),g(x.MaxWhen),gx.getMessage("GXPL_QViewerCardMaximum")))}}if(b.IncludeSparkline&&""!=u&&k)for(p=0;p<b.Metadata.Data.length;p++)k=s(b,y[p].ChartSeriesData,p),new Highcharts.Chart(k);b._ControlRenderedTo=b.RealType;qv.util.hideActivityIndicator(b)}return{tryToRenderCard:function(a){var b="";(new Date).getTime();a.xml=a.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(a,
function(a,c){var d=!1;a!=c.xml.recordsetCacheKey&&(c.xml.recordsetCacheKey=a,d=!0);qv.util.anyError(a)?(b=qv.util.getErrorFromText(a),qv.util.renderError(c,b)):(d&&qv.services.parseRecordsetCacheKeyXML(c),qv.services.GetMetadataIfNeeded(c,function(a,c){var d=false;if(a!=c.xml.metadata){c.xml.metadata=a;d=true}(new Date).getTime();if(qv.util.anyError(a)){b=qv.util.getErrorFromText(a);qv.util.renderError(c,b)}else{d&&qv.services.parseMetadataXML(c);qv.services.GetDataIfNeeded(c,function(a,c){var d=
false;if(a!=c.xml.data){c.xml.data=a;d=true}(new Date).getTime();if(qv.util.anyError(a)){b=qv.util.getErrorFromText(a);qv.util.renderError(c,b)}else{d&&qv.services.parseDataXML(c);o(c)}})}}))})},GetMetadataCard:function(a){return qv.util.GetDesigntimeMetadata(a)},GetDataCard:function(a){return a.xml.data},fireItemClickEvent:function(a,c,d){a=a.target.id;a=a.substr(a.lastIndexOf("_")+1);b(c.ItemClickData,c,a,d);c.ItemClick()}}}();
